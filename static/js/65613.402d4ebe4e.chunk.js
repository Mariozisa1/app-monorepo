!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ee300b7c-d008-488b-b453-b7fb3fb8815d",e._sentryDebugIdIdentifier="sentry-dbid-ee300b7c-d008-488b-b453-b7fb3fb8815d")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"5.5.1 (2024123091)"},(self.webpackChunkweb=self.webpackChunkweb||[]).push([[65613],{793437:(e,t,n)=>{n.d(t,{X:()=>OpenInAppButton});var r=n(586330),o=n(514041),a=n(908867),s=n(17617),i=n(490343),c=n(889949),l=n(726130),u=n(334439),d=n(663522),p=n(117746),m=n(911998),k=n(831085);function OpenInAppButton({buildDeepLinkUrl:e,buildFullUrl:t}){var n=(0,a.A)(),{result:f}=(0,m.yk)((0,r.A)((function*(){var t=e();return(yield p.Ay.linkingCanOpenURL(t))?t:""})),[e]),y=((0,o.useMemo)((function(){return d.Ay.isWebMobile?d.Ay.isWebMobileAndroid?"Open by OneKey Android":d.Ay.isWebMobileIOS?"Open by OneKey iOS":void 0:"Open by OneKey Desktop"}),[]),(0,o.useCallback)((0,r.A)((function*(){var e=yield t();i.Dialog.show({title:n.formatMessage({id:u.ETranslations.open_in_mobile_app}),floatingPanelProps:{overflow:"hidden"},renderContent:(0,k.jsxs)(i.Stack,{children:[(0,k.jsx)(i.Stack,{alignItems:"center",justifyContent:"center",overflow:"hidden",children:(0,k.jsx)(i.Stack,{p:"$4",borderRadius:"$6",borderCurve:"continuous",borderWidth:s.A.hairlineWidth,borderColor:"$borderSubdued",children:(0,k.jsx)(i.QRCode,{value:e,logo:c,logoSize:40,size:224})})}),(0,k.jsxs)(i.XStack,{m:"$-5",mt:"$5",py:"$4",px:"$5",backgroundColor:"$bgSubdued",alignItems:"center",children:[(0,k.jsx)(i.SizableText,{size:"$bodyMd",color:"$textSubdued",flex:1,children:n.formatMessage({id:u.ETranslations.dont_have_mobile_app_yet})}),(0,k.jsx)(i.Button,{size:"small",onPress:function(){(0,p.Dr)(l.A8)},children:n.formatMessage({id:u.ETranslations.global_download})})]})]}),showFooter:!1})})),[t,n]));return(0,k.jsx)(i.Button,{size:"small",onPress:y,"data-sentry-element":"Button","data-sentry-component":"OpenInAppButton","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/OpenInAppButton/index.tsx",children:n.formatMessage({id:u.ETranslations.open_in_mobile_app})})}},292600:(e,t,n)=>{n.d(t,{O:()=>ReviewControl,T:()=>useReviewControl});var r=n(471169),o=n(663522),useReviewControl=function(){var[{reviewControl:e}]=(0,r.useSettingsPersistAtom)();return!o.Ay.isAppleStoreEnv&&!o.Ay.isMas||Boolean(e)},ReviewControl=function({children:e}){return useReviewControl()?e:null}},407430:(e,t,n)=>{n.d(t,{B:()=>HeaderLeft});var r=n(586330),o=n(514041),a=n(908867),s=n(490343),i=n(334439),c=n(193068),l=n(595346),u=n(714191),d=n(317522),p=n(904121),m=n(812979),k=n(831085);function HeaderLeft({sceneName:e}){var t,n=(0,a.A)(),{tourTimes:f,tourVisited:y}=(0,m.c1)(l.A.switchDappAccount),[w,h]=(0,o.useState)(!1);(0,d.A)(c.V4.Home,(t=(0,r.A)((function*(e,t){h(!t&&e)})),function(e,n){return t.apply(this,arguments)}));var g=(0,o.useMemo)((function(){return 1===f&&w}),[w,f]),A=(0,o.useMemo)((function(){return e===u.Zs.homeUrlAccount?(0,k.jsx)(s.Page.Close,{children:(0,k.jsx)(s.NavBackButton,{})}):(0,k.jsx)(p.Qt,{num:0,spotlightProps:{visible:g,content:(0,k.jsx)(s.SizableText,{size:"$bodyMd",children:n.formatMessage({id:i.ETranslations.spotlight_account_alignment_desc})}),onConfirm:function(){y(2)},childrenPaddingVertical:0}},"accountSelectorTrigger")}),[n,e,g,y]);return(0,k.jsx)(p.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"HeaderLeft","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TabPageHeader/HeaderLeft.tsx",children:A})}},145337:(e,t,n)=>{n.d(t,{i:()=>TabPageHeader});var r=n(514041),o=n(490343),a=n(396304),s=n(162616),i=n(208257),c=n(904121),l=n(407430),u=n(586330),d=n(908867),p=n(896666),m=n(384013),k=n(471169),f=n(334439),y=n(296827),w=n(663522),h=n(193068),g=n(251039),A=n(187576),v=n(596020),b=n(714191),T=n(643087),x=n(498356),I=n(793437),S=n(211129),j=n(491180),L=n(796151),H=n(826339),N=n(831085);function OpenInAppButtonContainer(){var{activeAccount:{account:e,network:t}}=(0,s.LH)({num:0}),n=(0,r.useCallback)((function(){return e&&t?L.Ay.buildDeepLinkUrl({path:S.oO.url_account,query:{networkCode:t.code,address:e.address}}):""}),[e,t]),o=(0,r.useCallback)((0,u.A)((function*(){return e&&t?(0,H.Hw)({account:e,network:t}):"n"})),[e,t]);return e?.address&&t?.id?(0,N.jsx)(I.X,{buildDeepLinkUrl:n,buildFullUrl:o,"data-sentry-element":"OpenInAppButton","data-sentry-component":"OpenInAppButtonContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/urlAccount/UrlAccountNavHeader.tsx"}):null}function ShareButton(){var{activeAccount:{account:e,network:t}}=(0,s.LH)({num:0}),{shareText:n}=(0,o.useShare)();return e?.address&&t?.id?(0,N.jsx)(o.HeaderIconButton,{onPress:(0,u.A)((function*(){var r=yield(0,H.Hw)({account:e,network:t});yield n(r)})),icon:"ShareOutline","data-sentry-element":"HeaderIconButton","data-sentry-component":"ShareButton","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/urlAccount/UrlAccountNavHeader.tsx"}):null}var O={Address:function Address(){var{activeAccount:{account:e}}=(0,s.LH)({num:0});return(0,o.useMedia)(),(0,N.jsxs)(o.XStack,{alignItems:"center","data-sentry-element":"XStack","data-sentry-component":"Address","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/urlAccount/UrlAccountNavHeader.tsx",children:[(0,N.jsx)(o.SizableText,{size:"$headingLg","data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/urlAccount/UrlAccountNavHeader.tsx",children:j.A.shortenAddress({address:e?.address})}),null]})},OpenInApp:function OpenInApp(){return(0,N.jsx)(c.b8,{config:{sceneName:b.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"OpenInApp","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/urlAccount/UrlAccountNavHeader.tsx",children:(0,N.jsx)(OpenInAppButtonContainer,{"data-sentry-element":"OpenInAppButtonContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/urlAccount/UrlAccountNavHeader.tsx"})})},Share:function Share(){return(0,N.jsx)(c.b8,{config:{sceneName:b.Zs.homeUrlAccount,sceneUrl:""},enabledNum:[0],"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"Share","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/urlAccount/UrlAccountNavHeader.tsx",children:(0,N.jsx)(ShareButton,{"data-sentry-element":"ShareButton","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/urlAccount/UrlAccountNavHeader.tsx"})})}},C=n(834015),_=n(390574),R=n(747268),P=n(506851),E=n(89345),M=R.H.SearchInPage;function UniversalSearchInput(){var e=(0,d.A)(),t=(0,x.A)(),n=(0,r.useCallback)((function(){t.pushModal(h.ry.UniversalSearchModal,{screen:_.j.UniversalSearch,params:{filterType:P.j.Address}})}),[t]);return(0,E.U)(M,n),(0,N.jsxs)(o.XStack,{w:280,"data-sentry-element":"XStack","data-sentry-component":"UniversalSearchInput","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TabPageHeader/UniversalSearchInput.tsx",children:[(0,N.jsx)(o.Input,{leftIconName:"SearchOutline",containerProps:{w:"100%"},size:"small",addOns:[{label:(0,N.jsx)(o.Shortcut,{shortcutKey:M})}],placeholder:e.formatMessage({id:f.ETranslations.global_search_address}),"data-sentry-element":"Input","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TabPageHeader/UniversalSearchInput.tsx"},"searchInput"),(0,N.jsx)(o.View,{position:"absolute",top:0,left:0,right:0,bottom:0,onPress:n,"data-sentry-element":"View","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TabPageHeader/UniversalSearchInput.tsx"})]})}function HeaderRight({sceneName:e}){var t=(0,d.A)(),n=(0,x.A)(),a=(0,C.A)(),[{firstTimeGuideOpened:i,badge:c}]=(0,k.useNotificationsAtom)(),[l]=(0,k.useDevSettingsPersistAtom)(),{activeAccount:{account:I}}=(0,s.LH)({num:0}),[S]=(0,m.RI)(),[j]=(0,m.D4)(),L=(0,r.useCallback)((function(){n.pushModal(h.ry.SettingModal,{screen:h.Pj.SettingListModal})}),[n]),H=(0,r.useCallback)((function(){return a.start({handlers:a.PARSE_HANDLER_NAMES.all,autoHandleResult:!0,account:I,tokens:{data:S.tokens,keys:S.keys,map:j}})}),[a,I,S,j]),_=(0,o.useMedia)(),R=(0,r.useCallback)((0,u.A)((function*(){n.pushModal(h.ry.NotificationsModal,{screen:g.f.NotificationList})})),[n]),P=(0,r.useMemo)((function(){var n,r,a,s=_.gtMd?null:(0,N.jsx)(p.v$,{title:(0,N.jsxs)(o.XStack,{gap:"$2",children:[(0,N.jsx)(o.Tooltip.Text,{children:t.formatMessage({id:f.ETranslations.settings_settings})}),(0,N.jsxs)(o.Shortcut,{pl:"$2",children:[(0,N.jsx)(o.Shortcut.Key,{children:A.s.CmdOrCtrl}),(0,N.jsx)(o.Shortcut.Key,{children:","})]})]}),titlePlacement:"bottom",icon:"SettingsOutline",testID:"setting",onPress:L},"setting"),d={routes:""},m=(0,N.jsx)(o.ActionList,{title:t.formatMessage({id:f.ETranslations.global_layout}),items:[w.Ay.isExtensionUiPopup?{label:t.formatMessage({id:f.ETranslations.open_as_sidebar}),icon:"LayoutRightOutline",onPress:(a=(0,u.A)((function*(){y.U.account.wallet.openSidePanel(),yield v.Ay.openPanelOnActionClick(!0),yield v.Ay.openSidePanel(d),window.close()})),function onPress(){return a.apply(this,arguments)})}:{label:t.formatMessage({id:f.ETranslations.open_as_popup}),icon:"LayoutTopOutline",onPress:(r=(0,u.A)((function*(){yield v.Ay.openPanelOnActionClick(!1),window.close()})),function onPress(){return r.apply(this,arguments)})},{label:t.formatMessage({id:f.ETranslations.global_expand_view}),icon:"ExpandOutline",onPress:(n=(0,u.A)((function*(){y.U.account.wallet.openExpandView(),window.close(),yield T.A.serviceApp.openExtensionExpandTab(d)})),function onPress(){return n.apply(this,arguments)})}],renderTrigger:(0,N.jsx)(p.v$,{title:t.formatMessage({id:f.ETranslations.global_layout}),icon:"LayoutRightOutline"},"layoutRightView")},"layoutExtView"),k=(0,N.jsx)(p.v$,{title:t.formatMessage({id:f.ETranslations.scan_scan_qr_code}),icon:"ScanOutline",onPress:H},"scan"),h=(0,N.jsxs)(o.Stack,{testID:"headerRightNotificationsButton",children:[(0,N.jsx)(p.v$,{title:t.formatMessage({id:f.ETranslations.global_notifications}),icon:"BellOutline",onPress:R}),!i||c?(0,N.jsx)(o.Stack,{position:"absolute",right:"$-2.5",top:"$-2",alignItems:"flex-end",w:"$10",pointerEvents:"none",children:(0,N.jsx)(o.Stack,{bg:"$bgApp",borderRadius:"$full",borderWidth:2,borderColor:"$transparent",children:(0,N.jsx)(o.Stack,{px:"$1",borderRadius:"$full",bg:"$bgCriticalStrong",minWidth:"$4",height:"$4",alignItems:"center",justifyContent:"center",children:i?(0,N.jsx)(o.SizableText,{color:"$textOnColor",size:"$bodySm",children:c&&c>99?"99+":c}):(0,N.jsx)(o.Stack,{width:"$1",height:"$1",backgroundColor:"white",borderRadius:"$full"})})})}):null]},"notifications"),g=_.gtMd?(0,N.jsx)(UniversalSearchInput,{},"searchInput"):null;return e===b.Zs.homeUrlAccount?[(0,N.jsx)(O.OpenInApp,{},"urlAccountOpenInApp"),(0,N.jsx)(O.Share,{},"urlAccountShare")].filter(Boolean):w.Ay.isExtensionUiPopup||w.Ay.isExtensionUiSidePanel?[m,h,s].filter(Boolean):(l.enabled||(h=null),[k,h,s,g].filter(Boolean))}),[t,L,H,R,i,c,_.gtMd,e,l.enabled]);return(0,N.jsx)(p.bE,{testID:"Wallet-Page-Header-Right",className:"app-region-no-drag","data-sentry-element":"HeaderButtonGroup","data-sentry-component":"HeaderRight","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TabPageHeader/HeaderRight.tsx",children:P})}function HeaderTitle({sceneName:e}){var t=(0,r.useMemo)((function(){if(e===b.Zs.homeUrlAccount)return(0,N.jsx)(O.Address,{},"urlAccountNavHeaderAddress")}),[e]);return(0,N.jsx)(c.b8,{enabledNum:[0],config:{sceneName:e,sceneUrl:""},"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"HeaderTitle","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TabPageHeader/HeaderTitle.tsx",children:t})}function TabPageHeader({sceneName:e,showHeaderRight:t}){(0,a.eX)({name:`web TabPageHeader:${e}:${String(t)}`});var n=(0,r.useCallback)((function(){return(0,N.jsx)(l.B,{sceneName:e})}),[e]),{config:u}=(0,s.H9)(),d=(0,r.useCallback)((function(){return t&&u?(0,N.jsx)(i.p,{children:(0,N.jsx)(c.b8,{enabledNum:[0],config:u,children:(0,N.jsx)(HeaderRight,{sceneName:e})})}):null}),[u,e,t]),p=(0,r.useCallback)((function(){return(0,N.jsx)(HeaderTitle,{sceneName:e})}),[e]);return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(o.Page.Header,{headerTitle:p,headerLeft:n,headerRight:d,"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TabPageHeader/index.tsx"})})}},124155:(e,t,n)=>{n.d(t,{q:()=>TxHistoryListView});var r=n(324586),o=n(514041),a=n(908867),s=n(812715),i=n(490343),c=n(427745),l=n(334439),u=(n(663522),n(567807)),d=n(469365),p=n(232471),m=n(69983),k=n(616552),f=n(94034),y=n(357829),w=n(831085);function EmptyHistory(){var e=(0,a.A)();return(0,w.jsx)(i.Empty,{testID:"Wallet-No-History-Empty",icon:"ClockTimeHistoryOutline",title:e.formatMessage({id:l.ETranslations.no_transaction_title}),description:e.formatMessage({id:l.ETranslations.no_transaction_desc}),"data-sentry-element":"Empty","data-sentry-component":"EmptyHistory","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/Empty/EmptyHistory.tsx"})}var h=n(535864),g=n(712784),A=n.n(g),v=n(227428),b=n(327550);function TxHistoryListHeader({filteredHistory:e}){var[t]=(0,k.u5)(),{updateSearchKey:n}=(0,k.n8)().current;return(0,w.jsx)(i.Stack,{"data-sentry-element":"Stack","data-sentry-component":"TxHistoryListHeader","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TxHistoryListView/TxHistoryListHeader.tsx",children:(0,w.jsx)(b.W,{searchProps:{onChangeText:A()((function(e){return n(e)}),v.FV),searchResultCount:t&&t.length>=v.NZ?e.length:0},"data-sentry-element":"ListToolToolBar","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TxHistoryListView/TxHistoryListHeader.tsx"})})}var T=n(253185),x=n(714191),I=n(623973),S=n(230414),j=n(929296),L=n(195309),H=n(972715);function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,H.A)(e);if(t){var o=(0,H.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,L.A)(this,n)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function TxHistoryListItemErrorBoundary_createSuper(e){var t=TxHistoryListItemErrorBoundary_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,H.A)(e);if(t){var o=(0,H.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,L.A)(this,n)}}function TxHistoryListItemErrorBoundary_isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(TxHistoryListItemErrorBoundary_isNativeReflectConstruct=function(){return!!e})()}var N=function(e){(0,j.A)(TxHistoryListItemErrorBoundary,e);var t=TxHistoryListItemErrorBoundary_createSuper(TxHistoryListItemErrorBoundary);function TxHistoryListItemErrorBoundary(){return t.apply(this,arguments)}return TxHistoryListItemErrorBoundary.prototype.render=function render(){return this.state.error?(0,w.jsx)(i.SizableText,{"data-sentry-element":"SizableText","data-sentry-component":"TxHistoryListItemErrorBoundary","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TxHistoryListView/TxHistoryListItemErrorBoundary.tsx",children:this.state.error.message}):this.props.children},(0,S.A)(TxHistoryListItemErrorBoundary)}(function(e){(0,j.A)(ErrorBoundaryBase,e);var t=_createSuper(ErrorBoundaryBase);function ErrorBoundaryBase(...e){var n;return(n=t.call(this,...e)).state={error:null},n}var n=ErrorBoundaryBase.prototype;return n.componentDidCatch=function componentDidCatch(e,t){this.props?.onError?.(e,t?.componentStack||null),this.setState({error:e})},n.render=function render(){return this.props.children},(0,S.A)(ErrorBoundaryBase)}(o.PureComponent));function TxHistoryListItem(e){var{historyTx:t,tableLayout:n,onPress:r,showIcon:s,hideValue:c}=e,u=(0,a.A)(),{canReplaceTx:d,canCancelTx:m,handleReplaceTx:k}=(0,I.Y)({historyTx:t}),f=(0,o.useCallback)((function(){return d?t.decodedTx.status!==p.Y1.Pending?null:(0,w.jsx)(i.XStack,{pl:s?72:20,testID:"history-list-item-speed-up-and-cancel-buttons",pb:"$3",children:m?(0,w.jsxs)(i.XStack,{gap:"$3",children:[(0,w.jsx)(i.Button,{size:"small",variant:"primary",onPress:function(){return k({replaceType:p.It.SpeedUp})},children:u.formatMessage({id:l.ETranslations.global_speed_up})}),(0,w.jsx)(i.Button,{size:"small",onPress:function(){return k({replaceType:p.It.Cancel})},children:u.formatMessage({id:l.ETranslations.global_cancel})})]}):(0,w.jsx)(i.Button,{size:"small",variant:"primary",onPress:function(){return k({replaceType:p.It.SpeedUp})},children:u.formatMessage({id:l.ETranslations.speed_up_cancellation})})}):null}),[m,d,k,t.decodedTx.status,u,s]);return t&&t.decodedTx?(0,w.jsxs)(N,{"data-sentry-element":"TxHistoryListItemErrorBoundary","data-sentry-component":"TxHistoryListItem","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TxHistoryListView/TxHistoryListItem.tsx",children:[(0,w.jsx)(T.F,{hideValue:c,replaceType:t.replacedType,decodedTx:t.decodedTx,tableLayout:n,showIcon:s,componentType:x.B_.ListView,componentProps:{onPress:function(){return r?.(t)}},"data-sentry-element":"TxActionsListView","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TxHistoryListView/TxHistoryListItem.tsx"},t.id),f()]}):null}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ListFooterComponent=function(){var{result:e}=(0,f.A)(),t=(0,o.useMemo)((function(){return!!e?.showFloatingPanel}),[e?.showFloatingPanel]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(i.Stack,{h:"$5","data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TxHistoryListView/index.tsx"}),t?(0,w.jsx)(i.Stack,{h:"$16"}):null]})};function TxHistoryListViewSectionHeader(e){var{title:t,titleKey:n,data:r}=e,o=(0,a.A)(),s=t||o.formatMessage({id:n})||"";return r[0]&&r[0].decodedTx.status===p.Y1.Pending?(0,w.jsxs)(i.XStack,{h:"$9",px:"$5",alignItems:"center",bg:"$bgApp",space:"$2",children:[(0,w.jsx)(i.Stack,{w:"$2",height:"$2",backgroundColor:"$textCaution",borderRadius:"$full"}),(0,w.jsx)(i.SizableText,{numberOfLines:1,size:"$headingSm",color:"$textCaution",children:o.formatMessage({id:l.ETranslations.global_pending})})]}):(0,w.jsx)(i.SectionList.SectionHeader,{title:s,"data-sentry-element":"unknown","data-sentry-component":"TxHistoryListViewSectionHeader","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TxHistoryListView/index.tsx"})}function TxHistoryListView(e){var{data:t,isLoading:n,showHeader:r,ListHeaderComponent:a,showIcon:l,onPressHistory:p,tableLayout:f,initialized:g,contentContainerStyle:A,inTabList:v=!1,hideValue:b}=e,[T]=(0,k.u5)(),x=(0,o.useMemo)((function(){return(0,d.q8)({history:t,searchKey:T})}),[t,T]),{bottom:I,top:S}=(0,c.Or)(),{height:j}=(0,s.A)(),L=(0,o.useMemo)((function(){return(0,d.qG)({items:x,formatDate:function(e){return(0,u.Yq)(new Date(e),{hideTimeForever:!0})}})}),[x]),H=(0,o.useCallback)((function(e){return(0,w.jsx)(TxHistoryListItem,{hideValue:b,index:e.index,historyTx:e.item,showIcon:l,onPress:p,tableLayout:f})}),[b,p,l,f]),N=(0,o.useCallback)((function({section:{title:e,titleKey:t,data:n}}){return(0,w.jsx)(TxHistoryListViewSectionHeader,{title:e,titleKey:t,data:n})}),[]),{listViewProps:O,listViewRef:C,onLayout:_}=(0,m.q)({inTabList:v});return!g&&n?(0,w.jsxs)(i.Stack,_objectSpread(_objectSpread({},A),{},{children:[a,(0,w.jsx)(h.e,{tableLayout:f})]})):(0,w.jsx)(i.SectionList,_objectSpread(_objectSpread({},O),{},{renderScrollComponent:i.renderNestedScrollView,ref:C,contentContainerStyle:_objectSpread({},A),h:"100%",onLayout:_,sections:L,ListEmptyComponent:T?y.wE:EmptyHistory,estimatedItemSize:56,renderItem:H,renderSectionHeader:N,ListFooterComponent,ListHeaderComponent:r&&t?.length>0?(0,w.jsx)(TxHistoryListHeader,{filteredHistory:x}):a,keyExtractor:function(e,t){return e.id||t.toString(10)},"data-sentry-element":"SectionList","data-sentry-component":"TxHistoryListView","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TxHistoryListView/index.tsx"}))}},962771:(e,t,n)=>{n.d(t,{m:()=>useReceiveToken});var r=n(586330),o=n(514041),a=n(908867),s=n(498356),i=n(334439),c=n(193068),l=n(491180),u=n(553083),d=n(359395),p=n(643087),m=n(298254);function useReceiveToken({accountId:e,networkId:t,walletId:n,deriveInfo:k,deriveType:f,tokens:y,tokenListState:w}){var h=(0,a.A)(),{vaultSettings:g,account:A,network:v}=(0,m.b)({networkId:t,accountId:e}),b=(0,s.A)(),T=(0,o.useCallback)((function(o){var a;u.Ay.isLightningNetworkByNetworkId(t)?b.pushModal(c.ry.ReceiveModal,{screen:c.MD.CreateInvoice,params:{networkId:t,accountId:e}}):k&&(g?.isSingleToken||o?b.pushModal(c.ry.ReceiveModal,{screen:c.MD.ReceiveToken,params:{networkId:t,accountId:e,walletId:n,token:o}}):b.pushModal(c.ry.ReceiveModal,{screen:c.MD.ReceiveSelectToken,params:{title:h.formatMessage({id:i.ETranslations.global_receive}),networkId:t,accountId:e,tokens:y,tokenListState:w,searchAll:!0,closeAfterSelect:!1,footerTipText:h.formatMessage({id:i.ETranslations.receive_token_list_footer_text}),onSelect:(a=(0,r.A)((function*(r){var o,a,s,i,m,k,f,w;u.Ay.isLightningNetworkByNetworkId(r.networkId)?b.pushModal(c.ry.ReceiveModal,{screen:c.MD.CreateInvoice,params:{networkId:null!=(i=r.networkId)?i:"",accountId:null!=(m=r.accountId)?m:""}}):(yield p.A.serviceNetwork.getVaultSettings({networkId:null!=(o=r.networkId)?o:""})).mergeDeriveAssetsEnabled&&v?.isAllNetworks&&!l.A.isOthersWallet({walletId:n})?b.push(c.MD.ReceiveSelectDeriveAddress,{networkId:null!=(k=r.networkId)?k:"",indexedAccountId:null!=(f=A?.indexedAccountId)?f:"",token:r,tokenMap:y?.map,accountId:null!=(w=r.accountId)?w:"",actionType:d.rI.Select,onSelected:function({account:o}){var a,s;b.push(c.MD.ReceiveToken,{networkId:null!=(a=r.networkId)?a:t,accountId:null!=(s=o.id)?s:e,walletId:n,token:r})}}):b.push(c.MD.ReceiveToken,{networkId:null!=(a=r.networkId)?a:t,accountId:null!=(s=r.accountId)?s:e,walletId:n,token:r})})),function onSelect(e){return a.apply(this,arguments)})}}))}),[A?.indexedAccountId,e,k,h,b,v?.isAllNetworks,t,w,y,g?.isSingleToken,n]);return{handleOnReceive:T}}},623973:(e,t,n)=>{n.d(t,{Y:()=>useReplaceTx});var r=n(586330),o=n(514041),a=n(908867),s=n(490343),i=n(334439),c=n(193068),l=n(491180),u=n(232471),d=n(643087),p=n(498356),m=n(911998);function useReplaceTx({historyTx:e,onSuccess:t,isConfirmed:n}){var k,f=(0,p.A)(),y=(0,a.A)(),w=(0,m.yk)((0,r.A)((function*(){if(!e)return!1;var{accountId:t,networkId:r,status:o,encodedTx:a}=e.decodedTx;return!n&&(!!a&&(o===u.Y1.Pending&&(!!(yield d.A.serviceNetwork.getVaultSettings({networkId:r})).replaceTxEnabled&&d.A.serviceHistory.isEarliestLocalPendingTx({accountId:t,networkId:r,encodedTx:a}))))})),[e,n]).result,h=!!e&&e.replacedType!==u.It.Cancel,g=(0,o.useCallback)((k=(0,r.A)((function*({replaceType:n}){if(e){var{decodedTx:r}=e,{accountId:o,networkId:a}=r;if(w)if(l.A.isExternalAccount({accountId:o}))s.Toast.error({title:y.formatMessage({id:i.ETranslations.feedback_connected_accounts_speed_up_or_cancel})});else{var u=yield d.A.serviceSend.buildReplaceEncodedTx({accountId:o,networkId:a,decodedTx:r,replaceType:n});u&&f.pushModal(c.ry.SendModal,{screen:c.j$.SendReplaceTx,params:{accountId:o,networkId:a,replaceType:n,replaceEncodedTx:u,historyTx:e,onSuccess:t}})}}})),function(e){return k.apply(this,arguments)}),[w,e,y,f,t]);return{canReplaceTx:w,canCancelTx:h,handleReplaceTx:g}}},616552:(e,t,n)=>{n.d(t,{SX:()=>d,n8:()=>useHistoryListActions,u5:()=>y,UK:()=>p});var r=n(230414),o=n(929296),a=n(195309),s=n(972715),i=n(514041),c=n(657355),l=n(714178),u=n(809690),{Provider:d,withProvider:p,contextAtom:m,contextAtomMethod:k}=(0,u.f)(),{atom:f,use:y}=m("");function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,s.A)(e);if(t){var o=(0,s.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,a.A)(this,n)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var w=function(e){(0,o.A)(ContextJotaiActionsHistoryList,e);var t=_createSuper(ContextJotaiActionsHistoryList);function ContextJotaiActionsHistoryList(...e){var n;return(n=t.call(this,...e)).updateSearchKey=k((function(e,t,n){t(f(),n)})),n}return(0,r.A)(ContextJotaiActionsHistoryList)}(l.x),h=(0,c.jq)((function(){return new w}));function useHistoryListActions(){var e=h().updateSearchKey.use();return(0,i.useRef)({updateSearchKey:e})}},639563:(e,t,n)=>{n.d(t,{HM:()=>l,V8:()=>d,oV:()=>u});var r,o,a,s=n(586330),i=n(117746),c=n(643087),l=(r=(0,s.A)((function*({networkId:e,address:t}){if(e&&t){var n={networkId:e,param:t,type:"address"},r=yield c.A.serviceExplorer.buildExplorerUrl(n);(0,i.GE)(r)}})),function openExplorerAddressUrl(e){return r.apply(this,arguments)}),u=(o=(0,s.A)((function*({networkId:e,txid:t}){if(e&&t){var n={networkId:e,param:t,type:"transaction"},r=yield c.A.serviceExplorer.buildExplorerUrl(n);(0,i.GE)(r)}})),function openTransactionDetailsUrl(e){return o.apply(this,arguments)}),d=(a=(0,s.A)((function*({networkId:e,tokenAddress:t}){if(e&&t){var n={networkId:e,param:t,type:"token"},r=yield c.A.serviceExplorer.buildExplorerUrl(n);(0,i.GE)(r)}})),function openTokenDetailsUrl(e){return a.apply(this,arguments)})},69531:(e,t,n)=>{n.d(t,{M7:()=>useSupportToken,TH:()=>useFiatCrypto,ej:()=>useGetTokensList});var r=n(586330),o=n(514041),a=n(498356),s=n(384013),i=n(193068),c=n(553083),l=n(643087),u=n(911998),useSupportNetworkId=function(e,t){return(0,u.yk)((0,r.A)((function*(){return!!t&&(!!c.Ay.isAllNetwork({networkId:t})||l.A.serviceFiatCrypto.isNetworkSupported({networkId:t,type:e}))})),[t,e],{initResult:!1,debounced:100})},useSupportToken=function(e,t,n){return(0,u.yk)((0,r.A)((function*(){return l.A.serviceFiatCrypto.isTokenSupported({networkId:e,tokenAddress:t,type:n})})),[e,t,n],{initResult:!1,debounced:100})},useGetTokensList=function({networkId:e,type:t,accountId:n}){return(0,u.yk)((0,r.A)((function*(){return yield l.A.serviceFiatCrypto.getTokensList({networkId:e,type:t,accountId:n})})),[e,t,n],{initResult:[],watchLoading:!0})};function useFiatCrypto({accountId:e,networkId:t,fiatCryptoType:n}){var{result:r}=useSupportNetworkId(n,t),[c]=(0,s.RI)(),[l]=(0,s.D4)(),u=(0,a.A)();return{handleFiatCrypto:(0,o.useCallback)((function(){u.pushModal(i.ry.FiatCryptoModal,{screen:"buy"===n?i.Mg.BuyModal:i.Mg.SellModal,params:{networkId:t,accountId:e,tokens:c.tokens,map:l}})}),[e,u,t,c,l,n]),isSupported:Boolean(t&&e&&r)}}},349521:(e,t,n)=>{n.d(t,{F:()=>FirmwareUpdateReminderAlert,a:()=>HomeFirmwareUpdateReminder});var r=n(586330),o=n(514041),a=n(908867),s=n(490343),i=n(471169),c=n(334439),l=n(714191),u=n(643087),d=n(904121),p=n(498356),m=n(911998),k=n(162616),f=n(773831),y=n(318822);function BootloaderModeUpdateReminder(){var e=(0,p.A)(),t=(0,f.B)();return(0,o.useEffect)((function(){var fn=function(e){t.showBootloaderMode({connectId:e.connectId,existsFirmware:e.existsFirmware})};return y.iL.on(y.Tu.ShowFirmwareUpdateFromBootloaderMode,fn),function(){y.iL.off(y.Tu.ShowFirmwareUpdateFromBootloaderMode,fn)}}),[t,e]),null}var w=n(153763),h=n(491180),g=n(831085);function HomeFirmwareUpdateDetectCmp(){var{activeAccount:e}=(0,k.LH)({num:0}),t=e.device?.connectId,n=(0,w.E)(),r=(0,o.useMemo)((function(){return h.A.isHwWallet({walletId:e.wallet?.id})}),[e.wallet?.id]);return(0,o.useEffect)((function(){r&&t&&n&&u.A.serviceFirmwareUpdate.detectActiveAccountFirmwareUpdates({connectId:t})}),[r,t,n]),null}var A=(0,o.memo)((function HomeFirmwareUpdateDetectWithProvider(){var[e]=(0,i.useAppIsLockedAtom)();return e?null:(0,g.jsx)(d.b8,{config:{sceneName:l.Zs.home},enabledNum:[0],children:(0,g.jsx)(HomeFirmwareUpdateDetectCmp,{})})}));function FirmwareUpdateReminderAlert({message:e,onPress:t}){var n=(0,a.A)();return(0,g.jsxs)(s.XStack,{px:"$5",py:"$2",borderTopWidth:"$px",borderBottomWidth:"$px",bg:"$bgInfoSubdued",borderColor:"$borderInfoSubdued",alignItems:"center",gap:"$2",flex:1,"data-sentry-element":"XStack","data-sentry-component":"FirmwareUpdateReminderAlert","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/FirmwareUpdate/components/HomeFirmwareUpdateReminder.tsx",children:[(0,g.jsx)(s.Icon,{size:"$4",name:"DownloadOutline",color:"$iconInfo","data-sentry-element":"Icon","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/FirmwareUpdate/components/HomeFirmwareUpdateReminder.tsx"}),(0,g.jsx)(s.SizableText,{flex:1,size:"$bodyMdMedium",color:"$text",numberOfLines:1,"data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/FirmwareUpdate/components/HomeFirmwareUpdateReminder.tsx",children:e}),(0,g.jsx)(s.Button,{size:"small",onPress:t,"data-sentry-element":"Button","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/FirmwareUpdate/components/HomeFirmwareUpdateReminder.tsx",children:n.formatMessage({id:c.ETranslations.global_view})})]})}function HomeFirmwareUpdateReminderCmp(){var e=(0,a.A)(),{activeAccount:t}=(0,k.LH)({num:0}),n=t.device?.connectId,l=(0,f.B)(),[d]=(0,i.useFirmwareUpdatesDetectStatusPersistAtom)(),{result:y}=((0,p.A)(),(0,m.yk)((0,r.A)((function*(){if(n){var e=d?.[n],t=e?.connectId===n&&e?.hasUpgrade;yield u.A.serviceFirmwareUpdate.getFirmwareUpdateDetectInfo({connectId:n});return{shouldUpdate:t,detectResult:e}}})),[n,d])),w=(0,o.useMemo)((function(){if(y?.shouldUpdate){var t="New firmware is available";return y?.detectResult?.toVersion?t=e.formatMessage({id:c.ETranslations.update_firmware_version_available},{version:y?.detectResult?.toVersion}):y?.detectResult?.toVersionBle&&(t=e.formatMessage({id:c.ETranslations.update_bluetooth_version_available},{version:y?.detectResult?.toVersionBle})),(0,g.jsx)(FirmwareUpdateReminderAlert,{message:t,onPress:(0,r.A)((function*(){l.openChangeLogModal({connectId:n})}))})}return null}),[e,l,n,y]);return(0,g.jsxs)(s.XStack,{"data-sentry-element":"XStack","data-sentry-component":"HomeFirmwareUpdateReminderCmp","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/FirmwareUpdate/components/HomeFirmwareUpdateReminder.tsx",children:[(0,g.jsx)(A,{"data-sentry-element":"HomeFirmwareUpdateDetect","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/FirmwareUpdate/components/HomeFirmwareUpdateReminder.tsx"}),(0,g.jsx)(BootloaderModeUpdateReminder,{"data-sentry-element":"BootloaderModeUpdateReminder","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/FirmwareUpdate/components/HomeFirmwareUpdateReminder.tsx"}),w]})}function HomeFirmwareUpdateReminder(){return(0,g.jsx)(d.b8,{config:{sceneName:l.Zs.home},enabledNum:[0],"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"HomeFirmwareUpdateReminder","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/FirmwareUpdate/components/HomeFirmwareUpdateReminder.tsx",children:(0,g.jsx)(HomeFirmwareUpdateReminderCmp,{"data-sentry-element":"HomeFirmwareUpdateReminderCmp","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/FirmwareUpdate/components/HomeFirmwareUpdateReminder.tsx"})})}},918120:(e,t,n)=>{n.d(t,{m:()=>HomeTokenListProviderMirrorWrapper});var r=n(324586),o=n(839850),a=n(491180),s=n(208257),i=n(514041),c=n(641106),l=n(727476),u=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=(0,i.memo)((function(e){var t=(0,l.y)();return(0,u.jsx)(c.m,_objectSpread(_objectSpread({},e),{},{data:t}))}));d.displayName="UrlAccountHomeTokenListProviderMirror";var p=["accountId"];function HomeTokenListProvider_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeTokenListProvider_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeTokenListProvider_ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeTokenListProvider_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HomeTokenListProviderMirrorWrapper(e){var{accountId:t}=e,n=(0,o.A)(e,p);return a.A.isUrlAccountFn({accountId:t})?(0,u.jsx)(d,HomeTokenListProvider_objectSpread({},n)):(0,u.jsx)(s.p,HomeTokenListProvider_objectSpread({},n))}},398509:(e,t,n)=>{n.d(t,{A:()=>ActionItem,c:()=>RawActions});var r=n(324586),o=n(839850),a=n(514041),s=n(908867),i=n(490343),c=n(334439),l=n(831085),u=["icon","label","verticalContainerProps","showButtonStyle"],d=["children"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ActionItem(e){var{icon:t="PlaceholderOutline",label:n,verticalContainerProps:r,showButtonStyle:a=!1}=e,s=(0,o.A)(e,u),c=(0,i.useMedia)();return a||c.gtSm?(0,l.jsx)(i.Button,_objectSpread(_objectSpread(_objectSpread({},!n&&{icon:t,py:"$2",pl:"$2.5",pr:"$0.5"}),s),{},{children:n})):(0,l.jsxs)(i.Stack,_objectSpread(_objectSpread({alignItems:"center",maxWidth:50},r),{},{"data-sentry-element":"Stack","data-sentry-component":"ActionItem","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx",children:[(0,l.jsx)(i.IconButton,_objectSpread(_objectSpread({size:"large",icon:t},s),{},{"data-sentry-element":"IconButton","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx"})),(0,l.jsx)(i.SizableText,{mt:"$2",textAlign:"center",size:"$bodySm",color:"$textSubdued",minWidth:"$20",numberOfLines:1,"data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx",children:n})]}))}function RawActions(e){var{children:t}=e,n=(0,o.A)(e,d);return(0,l.jsx)(i.XStack,_objectSpread(_objectSpread({justifyContent:"space-between",$gtSm:{flexDirection:"row",justifyContent:"flex-start",gap:"$2"}},n),{},{"data-sentry-element":"XStack","data-sentry-component":"RawActions","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx",children:a.Children.toArray(t)}))}RawActions.More=function ActionMore({sections:e}){var t=(0,s.A)(),n=(0,i.useMedia)();return(0,l.jsx)(i.ActionList,{title:t.formatMessage({id:c.ETranslations.global_more}),floatingPanelProps:{w:"$60"},renderTrigger:(0,l.jsx)(ActionItem,_objectSpread({icon:"DotHorOutline"},n.sm&&{label:t.formatMessage({id:c.ETranslations.global_more})})),sections:e,"data-sentry-element":"ActionList","data-sentry-component":"ActionMore","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx"})},RawActions.Buy=function ActionBuy(e){var t=(0,s.A)();return(0,l.jsx)(ActionItem,_objectSpread(_objectSpread({label:t.formatMessage({id:c.ETranslations.global_buy}),icon:"PlusLargeOutline"},e),{},{"data-sentry-element":"ActionItem","data-sentry-component":"ActionBuy","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx"}))},RawActions.Sell=function ActionSell(e){var t=(0,s.A)();return(0,l.jsx)(ActionItem,_objectSpread(_objectSpread({label:t.formatMessage({id:c.ETranslations.global_cash_out}),icon:"MinusLargeOutline"},e),{},{"data-sentry-element":"ActionItem","data-sentry-component":"ActionSell","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx"}))},RawActions.Send=function ActionSend(e){var t=(0,s.A)();return(0,l.jsx)(ActionItem,_objectSpread(_objectSpread({label:t.formatMessage({id:c.ETranslations.global_send}),icon:"ArrowTopOutline"},e),{},{"data-sentry-element":"ActionItem","data-sentry-component":"ActionSend","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx"}))},RawActions.Receive=function ActionReceive(e){var t=(0,s.A)();return(0,l.jsx)(ActionItem,_objectSpread(_objectSpread({label:t.formatMessage({id:c.ETranslations.global_receive}),icon:"ArrowBottomOutline"},e),{},{"data-sentry-element":"ActionItem","data-sentry-component":"ActionReceive","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx"}))},RawActions.Swap=function ActionSwap(e){var t=(0,s.A)();return(0,l.jsx)(ActionItem,_objectSpread(_objectSpread({label:t.formatMessage({id:c.ETranslations.global_swap}),icon:"SwitchHorOutline"},e),{},{"data-sentry-element":"ActionItem","data-sentry-component":"ActionSwap","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx"}))},RawActions.Bridge=function ActionBridge(e){var t=(0,s.A)();return(0,l.jsx)(ActionItem,_objectSpread(_objectSpread({label:t.formatMessage({id:c.ETranslations.swap_page_bridge}),icon:"BridgeOutline"},e),{},{"data-sentry-element":"ActionItem","data-sentry-component":"ActionBridge","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/RawActions.tsx"}))}},323104:(e,t,n)=>{n.d(t,{A:()=>useHomePageWidth});var r=n(514041),o=n(812715),a=n(490343),s=n(40651),i=n(427745);function useHomePageWidth(){var e=(0,a.useMedia)(),t=(0,o.A)().width,n=(0,r.useMemo)((function(){return(0,i.RQ)().size.sideBarWidth.val}),[]),{leftSidebarCollapsed:c}=(0,s.A)();return{screenWidth:t,pageWidth:e.md||c?t:t-n}}},165613:(e,t,n)=>{n.d(t,{U:()=>HomePageView});var r=n(586330),o=n(514041),a=n(908867),s=n(546591),i=n(462723),c=n(490343),l=n(928557),u=n(318822),d=n(334439),p=(n(663522),n(491180)),m=n(714191),k=n(643087),f=n(357829),y=n(831085);var w=(0,o.memo)((function BasicNetworkAlert(){var{isInternetReachable:e}=(0,c.useNetInfo)(),t=(0,a.A)();return e?null:(0,y.jsx)(c.Alert,{type:"critical",icon:"CloudOffOutline",title:t.formatMessage({id:d.ETranslations.feedback_you_are_offline}),closable:!1,fullBleed:!0})})),h=n(145337),g=n(713132);n(117746),n(536612);g.ue.notify,g.ue.downloading,g.ue.verifying,g.ue.ready,g.ue.failed,g.ue.done;var UpdateReminder=function(){return null},A=n(911998),v=n(162616),b=n(349521),T=n(324586),x=n(839850),I=n(904121),S=n(575995),j=n(84269),L=["createAddressDisabled"];function HomeSelector_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeSelector_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeSelector_ownKeys(Object(n),!0).forEach((function(t){(0,T.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeSelector_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const H=(0,o.memo)((function HomeSelector(e){(0,c.useMedia)();var{createAddressDisabled:t}=e,n=(0,x.A)(e,L);return(0,y.jsxs)(c.XStack,HomeSelector_objectSpread(HomeSelector_objectSpread({testID:"Wallet-Address-Generator",alignItems:"center",gap:"$3"},n),{},{"data-sentry-element":"XStack","data-sentry-component":"HomeSelector","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/HomeSelector/index.tsx",children:[(0,y.jsx)(j.vO,{num:0,"data-sentry-element":"NetworkSelectorTriggerHome","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/HomeSelector/index.tsx"}),t?null:(0,y.jsx)(I.Ln,{num:0}),t?null:(0,y.jsx)(S.Xs,{num:0})]}))}));function HomeSupportedWallet({supportedDeviceTypes:e,watchingAccountEnabled:t}){var n=(0,a.A)(),r=[];e&&r.push(...e),t&&r.push("watching");var o={classic:"Classic",classic1s:"Classic 1S",mini:"Mini",touch:"Touch",pro:"Pro",unknown:"",watching:n.formatMessage({id:d.ETranslations.faq_watched_account})},s=(r||[]).map((function(e){return o[e]})).filter((function(e){return e}));return(0,y.jsxs)(c.YStack,{height:"100%","data-sentry-element":"YStack","data-sentry-component":"HomeSupportedWallet","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/HomeSupportedWallet/index.tsx",children:[(0,y.jsx)(H,{createAddressDisabled:!0,padding:"$5","data-sentry-element":"HomeSelector","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/HomeSupportedWallet/index.tsx"}),(0,y.jsx)(c.Stack,{flex:1,justifyContent:"center","data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/HomeSupportedWallet/index.tsx",children:(0,y.jsx)(c.Empty,{icon:"GlobusOutline",title:n.formatMessage({id:d.ETranslations.selected_network_only_supports_device},{deviceType:s.join(", ")}),"data-sentry-element":"Empty","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/HomeSupportedWallet/index.tsx"})})]})}var N=n(323104),O=n(208257),C=n(186207),_=n(292600),R=n(498356),P=n(384013),E=n(193068),M=n(359395),D=n(398509),F=n(69531),B=n(181447);function WalletActionBuy(){var e,t,{activeAccount:{network:n,account:r,wallet:a}}=(0,v.LH)({num:0}),{isSupported:s,handleFiatCrypto:i}=(0,F.TH)({networkId:null!=(e=n?.id)?e:"",accountId:null!=(t=r?.id)?t:"",fiatCryptoType:"buy"}),c=(0,o.useMemo)((function(){return a?.type===B.Hk||!s}),[s,a?.type]);return(0,y.jsx)(D.c.Buy,{onPress:i,disabled:c,"data-sentry-element":"unknown","data-sentry-component":"WalletActionBuy","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/WalletActionBuy.tsx"})}var $=n(404727),V=n(962771),W=n(639563),U=n(698318),z=n(471169);function WalletActionMore(){var e,t,n,s,i,l,[u]=(0,z.useDevSettingsPersistAtom)(),{activeAccount:p}=(0,v.LH)({num:0}),{account:m,network:f,wallet:w,deriveInfo:h,deriveType:g}=p,b=(0,a.A)(),{copyText:T}=(0,c.useClipboard)(),{handleOnReceive:x}=(0,V.m)({accountId:null!=(e=m?.id)?e:"",networkId:null!=(t=f?.id)?t:"",walletId:null!=(n=w?.id)?n:"",deriveInfo:h,deriveType:g}),{isAllNetworkEnabled:I,handleAllNetworkCopyAddress:S}=(0,U.s)({activeAccount:p}),{isSupported:j,handleFiatCrypto:L}=(0,F.TH)({accountId:null!=(s=m?.id)?s:"",networkId:null!=(i=f?.id)?i:"",fiatCryptoType:"sell"}),H=(0,o.useMemo)((function(){return w?.type===B.Hk||!j}),[j,w?.type]),N=(0,o.useCallback)((function(){I?S():w?.type===B.FN?x():T(m?.address||"")}),[m?.address,T,x,w?.type,I,S]),O=(0,_.T)(),C=(0,A.yk)((0,r.A)((function*(){var e;return yield k.A.serviceNetwork.getVaultSettings({networkId:null!=(e=f?.id)?e:""})})),[f?.id]).result,R=(0,A.yk)((0,r.A)((function*(){return!!f?.isCustomNetwork&&!f?.explorerURL})),[f?.isCustomNetwork,f?.explorerURL]).result,P=[];if(C?.copyAddressDisabled&&C?.hideBlockExplorer||P.unshift({items:[...C?.hideBlockExplorer?[]:[{label:b.formatMessage({id:d.ETranslations.global_view_in_blockchain_explorer}),icon:"GlobusOutline",onPress:function(){return(0,W.HM)({networkId:f?.id,address:m?.address})},disabled:R}],...C?.copyAddressDisabled?[]:[{label:b.formatMessage({id:d.ETranslations.global_copy_address}),icon:"Copy3Outline",onPress:N}]]}),O&&P.unshift({items:[{label:b.formatMessage({id:d.ETranslations.global_cash_out}),icon:"MinusLargeOutline",disabled:Boolean(H||!m?.id||!f?.id),onPress:L}]}),u?.settings?.showDevExportPrivateKey){var E=(l=(0,r.A)((function*({keyType:e}){var t="";t=e===$.ECoreApiExportedSecretKeyType.xpub||e===$.ECoreApiExportedSecretKeyType.publicKey?yield k.A.serviceAccount.exportAccountPublicKey({accountId:m?.id||"",networkId:f?.id||"",keyType:e}):yield k.A.serviceAccount.exportAccountSecretKey({accountId:m?.id||"",networkId:f?.id||"",keyType:e}),c.Dialog.show({title:"Key",description:t,onConfirmText:"Copy",onConfirm(){T(t||"")}})})),function exportAccountCredentialKey(e){return l.apply(this,arguments)});P.unshift({items:[{label:"Export Public Key",icon:"MinusLargeOutline",onPress:function(){E({keyType:$.ECoreApiExportedSecretKeyType.publicKey})}},{label:"Export xpub",icon:"MinusLargeOutline",onPress:function(){E({keyType:$.ECoreApiExportedSecretKeyType.xpub})}},{label:"Export Private Key",icon:"MinusLargeOutline",onPress:function(){E({keyType:$.ECoreApiExportedSecretKeyType.privateKey})}},{label:"Export xprvt",icon:"MinusLargeOutline",onPress:function(){E({keyType:$.ECoreApiExportedSecretKeyType.xprvt})}}]})}return(0,y.jsx)(D.c.More,{sections:P,"data-sentry-element":"unknown","data-sentry-component":"WalletActionMore","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/WalletActionMore.tsx"})}function WalletActionReceive(){var e,t,n,{activeAccount:{network:r,account:a,wallet:s,deriveInfo:i,deriveType:c}}=(0,v.LH)({num:0}),[l]=(0,P.RI)(),[u]=(0,P.D4)(),[d]=(0,P.V3)(),p=(0,o.useMemo)((function(){return s?.type===B.Hk}),[s?.type]),{handleOnReceive:m}=(0,V.m)({accountId:null!=(e=a?.id)?e:"",networkId:null!=(t=r?.id)?t:"",walletId:null!=(n=s?.id)?n:"",deriveInfo:i,deriveType:c,tokens:{data:l.tokens,keys:l.keys,map:u},tokenListState:d});return(0,y.jsx)(D.c.Receive,{disabled:p,onPress:function(){return m()},"data-sentry-element":"unknown","data-sentry-component":"WalletActionReceive","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/WalletActionReceive.tsx"})}function WalletActions_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function WalletActions_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?WalletActions_ownKeys(Object(n),!0).forEach((function(t){(0,T.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WalletActions_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function WalletActionSend(){var e=(0,R.A)(),{activeAccount:{account:t,network:n,wallet:s}}=(0,v.LH)({num:0}),i=(0,a.A)(),[c]=(0,P.RI)(),[l]=(0,P.D4)(),[u]=(0,P.V3)(),m=(0,A.yk)((0,r.A)((function*(){var e;return yield k.A.serviceNetwork.getVaultSettings({networkId:null!=(e=n?.id)?e:""})})),[n?.id]).result,f=(0,o.useCallback)((0,r.A)((function*(){if(t&&n)if(m?.isSingleToken){var o=yield k.A.serviceToken.getNativeToken({networkId:n.id,accountId:t.id});e.pushModal(E.ry.SendModal,{screen:E.j$.SendDataInput,params:{accountId:t.id,networkId:n.id,isNFT:!1,token:o}})}else{var a;e.pushModal(E.ry.SendModal,{screen:E.j$.SendSelectToken,params:{title:i.formatMessage({id:d.ETranslations.global_send}),searchPlaceholder:i.formatMessage({id:d.ETranslations.global_search_asset}),networkId:n.id,accountId:t.id,tokens:{data:c.tokens,keys:c.keys,map:l},tokenListState:u,closeAfterSelect:!1,onSelect:(a=(0,r.A)((function*(r){var o,a,i,c;if((yield k.A.serviceNetwork.getVaultSettings({networkId:null!=(o=r.networkId)?o:""})).mergeDeriveAssetsEnabled&&n.isAllNetworks&&!p.A.isOthersWallet({walletId:null!=(a=s?.id)?a:""})){var u,d,m,f,y=p.A.getWalletIdFromAccountId({accountId:null!=(u=r.accountId)?u:""});e.push(E.j$.SendSelectDeriveAddress,{networkId:null!=(d=r.networkId)?d:"",indexedAccountId:null!=(m=t.indexedAccountId)?m:"",walletId:y,accountId:null!=(f=r.accountId)?f:"",actionType:M.rI.Select,token:r,tokenMap:l,onUnmounted:function(){},onSelected:function({account:t}){var o;e.push(E.j$.SendDataInput,{accountId:t.id,networkId:null!=(o=r.networkId)?o:n.id,isNFT:!1,token:r,isAllNetworks:n?.isAllNetworks})}})}else e.push(E.j$.SendDataInput,{accountId:null!=(i=r.accountId)?i:t.id,networkId:null!=(c=r.networkId)?c:n.id,isNFT:!1,token:r,isAllNetworks:n?.isAllNetworks})})),function onSelect(e){return a.apply(this,arguments)})}})}})),[t,n,m?.isSingleToken,e,i,c.tokens,c.keys,l,u,s?.id]);return(0,y.jsx)(D.c.Send,{onPress:f,disabled:m?.disabledSendAction,"data-sentry-element":"unknown","data-sentry-component":"WalletActionSend","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/index.tsx"})}function WalletActionSwap({networkId:e,accountId:t}){var n=(0,a.A)(),s=(0,R.A)(),i=(0,A.yk)((0,r.A)((function*(){return yield k.A.serviceNetwork.getVaultSettings({networkId:null!=e?e:""})})),[e]).result,c=(0,o.useCallback)((function(){s.pushModal(E.ry.SwapModal,{screen:E.uw.SwapMainLand,params:{importNetworkId:e}})}),[s,e]);return(0,y.jsx)(D.c.Swap,{onPress:c,label:n.formatMessage({id:d.ETranslations.global_trade}),disabled:i?.disabledSwapAction||p.A.isUrlAccountFn({accountId:t}),"data-sentry-element":"unknown","data-sentry-component":"WalletActionSwap","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/index.tsx"})}function WalletActions(e){var t=Object.assign({},((0,C.A)(e),e)),{activeAccount:{network:n,account:r}}=(0,v.LH)({num:0});return(0,y.jsxs)(D.c,WalletActions_objectSpread(WalletActions_objectSpread({},t),{},{"data-sentry-element":"RawActions","data-sentry-component":"WalletActions","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/index.tsx",children:[(0,y.jsx)(_.O,{"data-sentry-element":"ReviewControl","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/index.tsx",children:(0,y.jsx)(WalletActionBuy,{"data-sentry-element":"WalletActionBuy","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/index.tsx"})}),(0,y.jsx)(WalletActionSwap,{networkId:n?.id,accountId:r?.id,"data-sentry-element":"WalletActionSwap","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/index.tsx"}),(0,y.jsx)(WalletActionSend,{"data-sentry-element":"WalletActionSend","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/index.tsx"}),(0,y.jsx)(WalletActionReceive,{"data-sentry-element":"WalletActionReceive","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/index.tsx"}),(0,y.jsx)(WalletActionMore,{"data-sentry-element":"WalletActionMore","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/WalletActions/index.tsx"})]}))}var K=n(241440),q=n(296827),X=n(403144),G=n(827037),Y=n(686233),J=n(989840),Z=n(432178);function HomeOverviewContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function HomeOverviewContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?HomeOverviewContainer_ownKeys(Object(n),!0).forEach((function(t){(0,T.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):HomeOverviewContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function HomeOverviewContainer(){var e,{activeAccount:{account:t,network:n,wallet:s}}=(0,v.LH)({num:0}),i=(0,a.A)(),[l,f]=(0,o.useState)(!1),[w,h]=(0,o.useState)(!1),[g,b]=(0,o.useState)(!1),[T,x]=(0,o.useState)(!1),I=(0,o.useRef)(""),[S]=(0,J.mw)(),[j]=(0,J.Al)(),{updateAccountOverviewState:L,updateAccountWorth:H}=(0,J.Lu)().current,[N]=(0,z.useSettingsPersistAtom)(),{result:O}=(0,A.yk)((0,r.A)((function*(){if(n)return k.A.serviceNetwork.getVaultSettings({networkId:n.id})})),[n]);(0,o.useEffect)((function(){t?.id&&n?.id&&s?.id&&n.isAllNetworks&&H({accountId:t.id,worth:{},initialized:!1})}),[t?.id,n?.id,n?.isAllNetworks,L,H,s?.id]),(0,o.useEffect)((function(){var fn=function({isRefreshing:e,type:t,accountId:n,networkId:r}){var o=`${n}-${r}`;!e&&I.current&&I.current!==o||(I.current=o,t===m.GV.TOKENS?h(e):t===m.GV.NFT?b(e):t===m.GV.HISTORY&&x(e),f(e))};return u.iL.on(u.Tu.TabListStateUpdate,fn),function(){u.iL.off(u.Tu.TabListStateUpdate,fn)}}),[]),(0,o.useEffect)((function(){if(t&&n&&S.initialized&&t.id===S.accountId)if(p.A.isOthersAccount({accountId:t.id})){if(!n.isAllNetworks&&t.createAtNetwork!==n.id)return;var e=t.id;k.A.serviceAccountProfile.updateAccountValue({accountId:e,value:S.createAtNetworkWorth,currency:N.currencyInfo.id,shouldUpdateActiveAccountValue:!0})}else{var r=t.indexedAccountId;n.isAllNetworks||k.A.serviceAccountProfile.updateAccountValueForSingleNetwork({accountId:r,value:S.worth[p.A.buildAccountValueKey({accountId:t.id,networkId:n.id})],currency:N.currencyInfo.id}),k.A.serviceAccountProfile.updateAllNetworkAccountValue({accountId:r,value:S.worth,currency:N.currencyInfo.id,updateAll:S.updateAll})}}),[t,S.accountId,S.createAtNetworkWorth,S.initialized,S.updateAll,S.worth,n,N.currencyInfo.id,s]);var{md:C}=(0,c.useMedia)(),_=(0,o.useRef)(null),R=(0,o.useRef)(null),P=(0,o.useCallback)((function(){l||(f(!0),u.iL.emit(u.Tu.AccountDataUpdate,void 0),q.U.account.wallet.walletManualRefresh())}),[l]),E=l||w||g||T,M=(0,o.useMemo)((function(){return(0,y.jsx)(c.IconButton,{icon:"RefreshCcwOutline",variant:"tertiary",loading:E,onPress:P})}),[P,E]),D=(0,o.useCallback)((0,r.A)((function*(){var e=yield z.settingsValuePersistAtom.get();yield z.settingsValuePersistAtom.set({hideValue:!e.hideValue})})),[]),F=(0,o.useCallback)((function(){var e,r;_?.current||(_.current=(0,Z.k)({accountId:null!=(e=t?.id)?e:"",networkId:null!=(r=n?.id)?r:"",onClose:function(){_.current=null}}))}),[t,n]),B=(0,o.useCallback)((function(){var e,r;R?.current||(R.current=(0,Y.u)({accountId:null!=(e=t?.id)?e:"",networkId:null!=(r=n?.id)?r:"",onClose:function(){R.current=null}}))}),[t?.id,n?.id]),$=(0,o.useMemo)((function(){var e,r,o,a;return n?.isAllNetworks?Object.values(S.worth).reduce((function(e,t){return new K.A(e).plus(t).toFixed()}),"0"):null!=(e=null!=(r=S.worth[p.A.buildAccountValueKey({accountId:null!=(o=t?.id)?o:"",networkId:null!=(a=n?.id)?a:""})])?r:Object.values(S.worth)[0])?e:"0"}),[S.worth,t?.id,n?.id,n?.isAllNetworks]);if(j.isRefreshing&&!j.initialized)return(0,y.jsx)(c.Stack,{py:"$2.5",children:(0,y.jsx)(c.Skeleton,{w:"$40",h:"$7",my:"$2.5"})});var V="$heading5xl",W={formatter:"value",formatterOptions:{currency:N.currencyInfo.symbol}};return(0,y.jsxs)(c.YStack,{gap:"$2.5",alignItems:"flex-start","data-sentry-element":"YStack","data-sentry-component":"HomeOverviewContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeOverviewContainer.tsx",children:[(0,y.jsxs)(c.XStack,{alignItems:"center",gap:"$3","data-sentry-element":"XStack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeOverviewContainer.tsx",children:[(0,y.jsx)(c.XStack,{flexShrink:1,borderRadius:"$3",px:"$1",py:"$0.5",mx:"$-1",my:"$-0.5",cursor:"default",focusable:!0,hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusVisibleStyle:{outlineColor:"$focusRing",outlineWidth:2,outlineOffset:0,outlineStyle:"solid"},onPress:D,"data-sentry-element":"XStack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeOverviewContainer.tsx",children:(0,y.jsx)(G.A,HomeOverviewContainer_objectSpread(HomeOverviewContainer_objectSpread({hideValue:!0,flexShrink:1,minWidth:0},W),{},{size:C&&null!=(e=[{length:17,size:"$headingXl"},{length:13,size:"$heading4xl"}].find((function(e){return(0,X.jq)(String($),W,!0).length>=e.length}))?.size)?e:V,"data-sentry-element":"NumberSizeableTextWrapper","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeOverviewContainer.tsx",children:$}))}),M]}),O?.hasFrozenBalance?(0,y.jsx)(c.Button,{onPress:F,variant:"tertiary",size:"small",iconAfter:"InfoCircleOutline",children:i.formatMessage({id:d.ETranslations.balance_detail_button_balance})}):void 0,O?.hasResource?(0,y.jsx)(c.Button,{onPress:B,variant:"tertiary",size:"small",iconAfter:"InfoCircleOutline",px:"$1",py:"$0.5",mx:"$-1",children:i.formatMessage({id:O.resourceKey})}):void 0]})}function HomeHeaderContainer(){return(0,y.jsx)(O.p,{"data-sentry-element":"HomeTokenListProviderMirror","data-sentry-component":"HomeHeaderContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeHeaderContainer.tsx",children:(0,y.jsxs)(c.Stack,{testID:"Wallet-Tab-Header",p:"$5",bg:"$bgApp","data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeHeaderContainer.tsx",children:[(0,y.jsx)(H,{mb:"$2.5","data-sentry-element":"HomeSelector","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeHeaderContainer.tsx"}),(0,y.jsxs)(c.Stack,{$gtLg:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},"data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeHeaderContainer.tsx",children:[(0,y.jsx)(HomeOverviewContainer,{"data-sentry-element":"HomeOverviewContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeHeaderContainer.tsx"}),(0,y.jsx)(WalletActions,{pt:"$5",$gtLg:{pt:0},"data-sentry-element":"WalletActions","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/HomeHeaderContainer.tsx"})]})]})})}var Q=n(603514),ee=n.n(Q),te=n(787835),ne=n.n(te),re=n(625931),oe=n(227428),ae=n(79110),se=n(482407),ie=n(520202),ce=n(712244),le={current:""};function useAllNetworkRequests(e){var{accountId:t,networkId:n,walletId:a,isAllNetworks:s,allNetworkRequests:i,allNetworkCacheRequests:c,allNetworkCacheData:l,allNetworkAccountsData:u,abortAllNetworkRequests:d,clearAllNetworkData:p,isNFTRequests:m,disabled:f,interval:y=0,shouldAlwaysFetch:w,onStarted:h,onFinished:g}=e,v=(0,o.useRef)(!1),b=(0,o.useRef)(!1),[T,x]=(0,o.useState)(!1);(0,o.useEffect)((function(){t&&n&&a&&ce.c.markStart("useAllNetworkRequestsRun_debounceDelay")}),[t,n,a]);var{run:I,result:S}=(0,A.yk)((0,r.A)((function*(){var e;ce.c.markEnd("useAllNetworkRequestsRun_debounceDelay"," useAllNetworkRequests  usePromiseResult debounced : POLLING_DEBOUNCE_INTERVAL");var o=ae.A.createPerf({name:ae.D.allNetwork__useAllNetworkRequests});ce.c.markStart("useAllNetworkRequestsRun");var y=(0,se.lk)();if(!f&&!b.current&&t&&n&&a&&s){b.current=!0,v.current||p(),d?.(),o.markStart("getAllNetworkAccountsWithEnabledNetworks");var{accountsInfo:w,accountsInfoBackendIndexed:A,accountsInfoBackendNotIndexed:T,allAccountsInfo:I}=yield k.A.serviceAllNetwork.getAllNetworkAccountsWithEnabledNetworks({accountId:t,networkId:n,deriveType:void 0,nftEnabledOnly:m});o.markEnd("getAllNetworkAccountsWithEnabledNetworks"),u?.({accounts:w,allAccounts:I}),w&&!ee()(w)||(x(!0),b.current=!1);var S,j=null;if(0===w.length&&(x(!0),b.current=!1),x(!1),h?.({accountId:t,networkId:n}),!v.current)try{var L;o.markStart("localTokens_getRawData");var H=null!=(L=yield k.A.simpleDb.localTokens.getRawData())?L:void 0;o.markEnd("localTokens_getRawData"),o.markStart("allNetworkCacheRequests",{localTokensExists:Boolean(H)});var N=(yield Promise.all(Array.from(w).map((S=(0,r.A)((function*(e){var{accountId:t,networkId:n,accountXpub:r,apiAddress:o,dbAccount:a}=e;return yield c?.({dbAccount:a,accountId:t,networkId:n,xpub:r,accountAddress:o,simpleDbLocalTokensRawData:H})})),function(e){return S.apply(this,arguments)})))).filter(Boolean);o.markEnd("allNetworkCacheRequests"),N&&!ee()(N)&&(v.current=!0,o.done(),ce.c.markEnd("useAllNetworkRequestsRun"," EPerformanceTimerLogNames.allNetwork__useAllNetworkRequests"),l?.({data:N,accountId:t,networkId:n}))}catch(e){}le.current=y;var O=null!=(e=yield k.A.simpleDb.customTokens.getRawData())?e:void 0;if(v.current){var C=w.map((function(e){var{accountId:t,networkId:n,dbAccount:r}=e;return i({customTokensRawData:O,accountId:t,networkId:n,dbAccount:r,allNetworkDataInit:v.current})}));try{j=(yield(0,ie.Ah)(C,{continueOnError:!0})).filter(Boolean)}catch(e){j=null,d?.()}}else{try{var _=Array.from(A).map((function(e){var{accountId:t,networkId:n,apiAddress:r}=e;return i({accountId:t,networkId:n,allNetworkDataInit:v.current,customTokensRawData:O})}));yield(0,ie.Ah)(_,{continueOnError:!0})}catch(e){}try{var R=Array.from(T).map((function(e){var{accountId:t,networkId:n,apiAddress:r}=e;return i({accountId:t,networkId:n,allNetworkDataInit:v.current,customTokensRawData:O})}));yield(0,ie.Ah)(R,{continueOnError:!0})}catch(e){}}return v.current=!0,b.current=!1,g?.({accountId:t,networkId:n}),j}})),[f,t,n,a,s,d,m,u,h,g,p,c,l,i],{debounced:oe.EI,overrideIsFocused:function(e){return e||!!w}});return(0,o.useEffect)((function(){t&&n&&a&&(v.current=!1)}),[t,n,a]),{run:I,result:S,isEmptyAccount:T,allNetworkDataInit:v}}var ue=n(230414),de=n(929296),pe=n(195309),me=n(972715),ke=n(657355),fe=n(714178),ye=n(809690),{Provider:we,withProvider:he,contextAtom:ge,contextAtomMethod:Ae}=(0,ye.f)(),{atom:ve,use:be}=ge("");function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var n,r=(0,me.A)(e);if(t){var o=(0,me.A)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,pe.A)(this,n)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var Te=function(e){(0,de.A)(ContextJotaiActionsNFTList,e);var t=_createSuper(ContextJotaiActionsNFTList);function ContextJotaiActionsNFTList(...e){var n;return(n=t.call(this,...e)).updateSearchKey=Ae((function(e,t,n){t(ve(),n)})),n}return(0,ue.A)(ContextJotaiActionsNFTList)}(fe.x),xe=(0,ke.jq)((function(){return new Te}));function useNFTListActions(){var e=xe().updateSearchKey.use();return(0,o.useRef)({updateSearchKey:e})}var Ie=n(535864),Se=n(69983),je=n(94034),Le=n(669617),He=n(712784),Ne=n.n(He),Oe=n(327550);function NFTListHeader(e){var{filteredNfts:t}=e,n=(0,a.A)(),[r]=be(),{updateSearchKey:o}=useNFTListActions().current;return(0,y.jsx)(Oe.W,{px:"$2.5",searchProps:{placeholder:n.formatMessage({id:d.ETranslations.global_search_asset}),onChangeText:Ne()((function(e){return o(e)}),oe.FV),searchResultCount:r&&r.length>=oe.NZ?t.length:0},"data-sentry-element":"ListToolToolBar","data-sentry-component":"NFTListHeader","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListHeader.tsx"})}var Ce=n(880590),_e=n(298254),Re=n(982447);var Pe=(0,o.memo)((function BasicNFTListItem(e){var t,{nft:n,onPress:r,flexBasis:a,isAllNetworks:s}=e,[i,l]=(0,o.useState)(!!n.metadata?.image),{network:u}=(0,_e.b)({networkId:n.networkId});return(0,y.jsxs)(c.Stack,{group:"nftItem",flexBasis:a,focusable:!0,focusVisibleStyle:{outlineColor:"$focusRing",outlineWidth:2,outlineStyle:"solid",outlineOffset:-2},p:"$2.5",borderRadius:"$4",onPress:function(){r?.(n)},userSelect:"none","data-sentry-element":"Stack","data-sentry-component":"BasicNFTListItem","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx",children:[(0,y.jsx)(c.Stack,{pb:"100%","$group-nftItem-hover":{opacity:.8},"data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx",children:(0,y.jsxs)(c.Stack,{position:"absolute",left:0,top:0,right:0,bottom:0,"data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx",children:[(0,y.jsxs)(c.Image,{w:"100%",h:"100%",borderRadius:"$2.5","data-sentry-element":"Image","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx",children:[i?(0,y.jsx)(c.Video,{source:{uri:n.metadata?.image},onError:function(){return l(!1)},style:{width:"100%",height:"100%",position:"absolute",zIndex:1},autoPlay:!1}):(0,y.jsx)(c.Image.Source,{src:n.metadata?.image}),(0,y.jsx)(c.Image.Fallback,{bg:"$bgStrong",justifyContent:"center",alignItems:"center","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx",children:(0,y.jsx)(c.Icon,{name:"ImageSquareWavesOutline",color:"$iconDisabled","data-sentry-element":"Icon","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx"})})]}),n.collectionType===Re.m.ERC1155&&new K.A(null!=(t=n.amount)?t:1).gt(1)?(0,y.jsx)(c.Stack,{borderRadius:"$2.5",position:"absolute",right:"$0",bottom:"$0",px:"$2",bg:"$bgInverse",borderWidth:2,borderColor:"$bgApp",children:(0,y.jsxs)(c.SizableText,{size:"$bodyMdMedium",color:"$textInverse",children:["x",new K.A(n.amount).gt(oe.JA)?`${oe.JA}+`:n.amount]})}):null]})}),(0,y.jsxs)(c.Stack,{mt:"$2","data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx",children:[(0,y.jsxs)(c.XStack,{alignItems:"center",justifyContent:"space-between","data-sentry-element":"XStack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx",children:[(0,y.jsx)(c.SizableText,{size:"$bodySm",color:"$textSubdued",minWidth:0,flex:1,numberOfLines:1,pr:"$2","data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx",children:n.collectionName||"-"}),s?(0,y.jsx)(Ce.um,{networkId:u?.id,size:"$3.5"}):null]}),(0,y.jsx)(c.SizableText,{size:"$bodyLgMedium",numberOfLines:1,"data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/NFTListItem.tsx",children:n.metadata?.name||"-"})]})]},n.itemId)}));function NFTListView_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function NFTListView_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NFTListView_ownKeys(Object(n),!0).forEach((function(t){(0,T.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NFTListView_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var useMumColumns=function(){var{gtSm:e,gtLg:t,gtXl:n,gt2xl:r}=(0,c.useMedia)();return(0,o.useMemo)((function(){return r?{flexBasis:"14.2857142857%",numColumns:7}:n?{flexBasis:"16.666666%",numColumns:6}:t?{flexBasis:"25%",numColumns:4}:e?{flexBasis:"33.333333%",numColumns:3}:{flexBasis:"50%",numColumns:2}}),[r,t,e,n])};function NFTListView(e){var{data:t,isLoading:n,initialized:r,inTabList:a=!1,isAllNetworks:s}=e,[i]=be(),l=(0,Le.D_)({nfts:t,searchKey:i}),u=(0,R.A)(),{activeAccount:{account:d,network:p,wallet:m}}=(0,v.LH)({num:0}),k=(0,o.useCallback)((function(e){var t,n;d&&p&&m&&u.pushModal(E.ry.MainModal,{screen:E.kZ.NFTDetails,params:{networkId:null!=(t=e.networkId)?t:p.id,accountId:null!=(n=e.accountId)?n:d.id,walletId:m.id,collectionAddress:e.collectionAddress,itemId:e.itemId}})}),[d,u,p,m]),{flexBasis:w,numColumns:h}=useMumColumns(),g=(0,o.useCallback)((function({item:e}){return(0,y.jsx)(Pe,{nft:e,flexBasis:w,onPress:k,isAllNetworks:s},`${e.collectionAddress}-${e.itemId}`)}),[w,k,s]),{listViewProps:A,listViewRef:b,onLayout:T}=(0,Se.q)({inTabList:a}),x=(0,o.useMemo)((function(){return{pb:"$6",px:"$2.5"}}),[]),{result:I}=(0,je.A)(),S=(0,o.useMemo)((function(){return!!I?.showFloatingPanel}),[I?.showFloatingPanel]);return!r&&n?(0,y.jsx)(Ie.yu,{}):(0,o.createElement)(c.ListView,NFTListView_objectSpread(NFTListView_objectSpread({},A),{},{ref:b,renderScrollComponent:c.renderNestedScrollView,key:h,onLayout:T,contentContainerStyle:x,numColumns:h,data:l,renderItem:g,ListHeaderComponent:(0,y.jsx)(NFTListHeader,{filteredNfts:l}),ListEmptyComponent:i?(0,y.jsx)(f.wE,{}):(0,y.jsx)(f.eZ,{}),ListFooterComponent:(0,y.jsx)(y.Fragment,{children:S?(0,y.jsx)(c.Stack,{h:"$16"}):null}),"data-sentry-element":"ListView","data-sentry-component":"NFTListView","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/components/NFTListView/index.tsx"}))}var Ee=(0,re.V)();var Me=(0,o.memo)(he((function NFTListContainer(e){var t,n,{isFocused:a,isHeaderRefreshing:s,setIsHeaderRefreshing:i}=(0,c.useTabIsRefreshingFocused)(),{updateAllNetworksState:l}=(0,J.Lu)().current,{updateSearchKey:d}=useNFTListActions().current,[p,f]=(0,o.useState)({initialized:!1,isRefreshing:!1}),[w,h]=(0,o.useState)([]),{activeAccount:{account:g,network:b,wallet:T}}=(0,v.LH)({num:0}),{run:x}=(0,A.yk)((0,r.A)((function*(){if(g&&b&&!b.isAllNetworks){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:m.GV.NFT,accountId:g.id,networkId:b.id}),yield k.A.serviceNFT.abortFetchAccountNFTs();var e=yield k.A.serviceNFT.fetchAccountNFTs({accountId:g.id,networkId:b.id,saveToLocal:!0});return f({initialized:!0,isRefreshing:!1}),i(!1),h(e.data),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:m.GV.NFT,accountId:g.id,networkId:b.id}),e.data}})),[g,b,i],{overrideIsFocused:function(e){return e&&a},debounced:oe.EI,pollingInterval:oe.Pi}),I=(0,o.useRef)(!1),S=(0,o.useCallback)((t=(0,r.A)((function*({accountId:e,networkId:t,allNetworkDataInit:n,dbAccount:r}){var o=yield k.A.serviceNFT.fetchAccountNFTs({dbAccount:r,accountId:e,networkId:t,isAllNetworks:!0,isManualRefresh:I.current,allNetworksAccountId:g?.id,allNetworksNetworkId:b?.id,saveToLocal:!0});return!n&&o.networkId===Ee.onekeyall&&o.isSameAllNetworksAccountData&&(h((function(e){return ne()([...e,...o.data],(function(e){return`${e.collectionAddress}_${e.itemId}`}))})),f({initialized:!0,isRefreshing:!1})),I.current=!1,o})),function(e){return t.apply(this,arguments)}),[g?.id,b?.id]),j=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:m.GV.NFT,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),L=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:m.GV.NFT,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),H=(0,o.useCallback)((function(){return h([])}),[]),N=(0,o.useCallback)((n=(0,r.A)((function*({dbAccount:e,accountId:t,networkId:n}){var r=yield k.A.serviceNFT.getAccountLocalNFTs({dbAccount:e,accountId:t,networkId:n});return ee()(r)?null:r})),function(e){return n.apply(this,arguments)}),[]),O=(0,o.useCallback)((function({data:e}){var t=e.flat();ee()(t)||(h(t),f({initialized:!0,isRefreshing:!1}))}),[]),C=(0,o.useCallback)((function({allAccounts:e}){l({visibleCount:ne()(e,"networkId").length})}),[l]),{run:_,result:R,isEmptyAccount:P}=useAllNetworkRequests({accountId:g?.id,networkId:b?.id,walletId:T?.id,isAllNetworks:b?.isAllNetworks,allNetworkRequests:S,allNetworkCacheRequests:N,allNetworkCacheData:O,clearAllNetworkData:H,allNetworkAccountsData:C,isNFTRequests:!0,onStarted:L,onFinished:j}),E=(0,o.useCallback)((function(){I.current=!0,_()}),[_]);return(0,o.useEffect)((function(){if(R){var e=[];for(var t of R)e=e.concat(t.data);h(ne()(e,(function(e){return`${e.collectionAddress}_${e.itemId}`})))}}),[R]),(0,o.useEffect)((function(){var e,t=(e=(0,r.A)((function*(e,t){var n=yield k.A.serviceNFT.getAccountLocalNFTs({accountId:e,networkId:t});ee()(n)?f({initialized:!1,isRefreshing:!0}):(h(n),f({initialized:!0,isRefreshing:!1})),d(""),k.A.serviceNFT.updateCurrentAccount({networkId:t,accountId:e})})),function initNFTsState(t,n){return e.apply(this,arguments)});g?.id&&b?.id&&T?.id&&t(g.id,b.id)}),[g?.id,b?.id,d,T?.id]),(0,o.useEffect)((function(){s&&x()}),[s,x]),(0,o.useEffect)((function(){b?.isAllNetworks&&P&&(h([]),f({initialized:!0,isRefreshing:!1}))}),[P,b?.isAllNetworks]),(0,o.useEffect)((function(){var fn=function(){a&&(b?.isAllNetworks?E():x())};return u.iL.on(u.Tu.AccountDataUpdate,fn),u.iL.on(u.Tu.NetworkDeriveTypeChanged,fn),function(){u.iL.off(u.Tu.AccountDataUpdate,fn),u.iL.off(u.Tu.NetworkDeriveTypeChanged,fn)}}),[E,a,b?.isAllNetworks,x]),(0,y.jsx)(NFTListView,{inTabList:!0,data:null!=w?w:[],isLoading:p.isRefreshing,initialized:p.initialized,isAllNetworks:b?.isAllNetworks,"data-sentry-element":"NFTListView","data-sentry-component":"NFTListContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/NFTListContainer.tsx"})}))),De=n(503668),Fe=n.n(De),Be=n(892819),$e=n(578104),Ve=n(734818),We=n(284781);var Ue=n(918120);function TokenListContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function TokenListContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TokenListContainer_ownKeys(Object(n),!0).forEach((function(t){(0,T.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TokenListContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze=(0,re.V)();function TokenListContainer(e){var t,n,a,s,i,l,d,f,w,{isFocused:h,isHeaderRefreshing:g,setIsHeaderRefreshing:b}=(0,c.useTabIsRefreshingFocused)(),{activeAccount:{account:T,network:x,wallet:I,indexedAccount:S,isOthersWallet:j,deriveInfo:L,deriveType:H}}=(0,v.LH)({num:0}),[N,O]=(0,o.useState)(!1),[C,_]=(0,o.useState)(void 0),M=(0,o.useRef)({keys:"",tokens:[],map:{}}),D=(0,o.useRef)({keys:"",tokens:[],map:{}}),{vaultSettings:$}=(0,_e.b)({networkId:null!=(t=x?.id)?t:""}),{handleFiatCrypto:W,isSupported:U}=(0,F.TH)({accountId:null!=(n=T?.id)?n:"",networkId:null!=(a=x?.id)?a:"",fiatCryptoType:"buy"}),{handleOnReceive:z}=(0,V.m)({accountId:null!=(s=T?.id)?s:"",networkId:null!=(i=x?.id)?i:"",walletId:null!=(l=I?.id)?l:"",deriveInfo:L,deriveType:H}),{handleOnManageToken:q,manageTokenEnabled:X}=function useManageToken({accountId:e,networkId:t,walletId:n,isOthersWallet:r,indexedAccountId:a,deriveType:s}){var i=(0,R.A)();return{manageTokenEnabled:!0,handleOnManageToken:(0,o.useCallback)((function(){i.pushModal(E.ry.MainModal,{screen:E.jX.TokenManagerModal,params:{walletId:n,isOthersWallet:r,indexedAccountId:a,networkId:t,accountId:e,deriveType:s}})}),[i,n,r,a,t,e,s])}}({accountId:null!=(d=T?.id)?d:"",networkId:null!=(f=x?.id)?f:"",walletId:null!=(w=I?.id)?w:"",deriveType:H,indexedAccountId:S?.id,isOthersWallet:j}),G=(0,c.useMedia)(),Y=(0,R.A)();(0,c.useOnRouterChange)((function(e){var t=e?.routes.find((function({name:e}){return e===E.WP.Modal}));t?.params?.screen===E.ry.SendModal&&t?.params?.params?.screen===E.j$.SendSelectToken||t?.params?.screen===E.ry.ReceiveModal&&t?.params?.params?.screen===E.MD.ReceiveSelectToken?O(!0):O(!1)}));var Z,Q,{refreshAllTokenList:te,refreshAllTokenListMap:re,refreshTokenList:se,refreshTokenListMap:ie,refreshRiskyTokenList:le,refreshRiskyTokenListMap:ue,refreshSmallBalanceTokenList:de,refreshSmallBalanceTokenListMap:pe,refreshSmallBalanceTokensFiatValue:me,updateTokenListState:ke,updateSearchKey:fe}=(0,P.WE)().current,{updateAccountWorth:ye,updateAccountOverviewState:we,updateAllNetworksState:he}=(0,J.Lu)().current,{run:ge}=(0,A.yk)((0,r.A)((function*(){try{var e,t,n,r;if(!T||!x)return;if(x.isAllNetworks)return;u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:m.GV.TOKENS,accountId:T.id,networkId:x.id}),yield k.A.serviceToken.abortFetchAccountTokens();var o=yield k.A.serviceToken.fetchAccountTokens({accountId:T.id,mergeTokens:!0,networkId:x.id,flag:"home-token-list",saveToLocal:!0}),a=new K.A(0);if(a=a.plus(null!=(e=o.tokens.fiatValue)?e:"0").plus(null!=(t=o.riskTokens.fiatValue)?t:"0").plus(null!=(n=o.smallBalanceTokens.fiatValue)?n:"0"),we({isRefreshing:!1,initialized:!0}),ye({accountId:T.id,initialized:!0,worth:{[p.A.buildAccountValueKey({accountId:T.id,networkId:x.id})]:a.toFixed()},createAtNetworkWorth:a.toFixed(),merge:!1}),se({keys:o.tokens.keys,tokens:o.tokens.data}),ie({tokens:TokenListContainer_objectSpread(TokenListContainer_objectSpread(TokenListContainer_objectSpread({},o.tokens.map),o.smallBalanceTokens.map),o.riskTokens.map)}),le({keys:o.riskTokens.keys,riskyTokens:o.riskTokens.data}),ue({tokens:o.riskTokens.map}),de({keys:o.smallBalanceTokens.keys,smallBalanceTokens:o.smallBalanceTokens.data}),pe({tokens:o.smallBalanceTokens.map}),me({value:null!=(r=o.smallBalanceTokens.fiatValue)?r:"0"}),o.allTokens){te({keys:o.allTokens?.keys,tokens:o.allTokens?.data}),re({tokens:o.allTokens.map});var s=o.allTokens.data;s&&s.length&&k.A.serviceToken.updateLocalTokens({networkId:x.id,tokens:s}),ce.c.markEnd("tokenListRefreshing_tokenListContainerRefreshList"),ke({initialized:!0,isRefreshing:!1}),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:m.GV.TOKENS,accountId:T.id,networkId:x.id})}}catch(e){var i,c;if(u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:m.GV.TOKENS,accountId:null!=(i=T?.id)?i:"",networkId:null!=(c=x?.id)?c:""}),!(e instanceof Be.k3))throw e}finally{b(!1)}})),[T,x,se,ie,le,ue,de,pe,me,te,re,ke,b,we,ye],{overrideIsFocused:function(e){return e&&h||N},debounced:oe.EI,pollingInterval:oe.iD}),Ae=(0,o.useRef)(!1),ve=(0,$e.dh)((function(){se({keys:M.current.keys,tokens:M.current.tokens,merge:!0,map:M.current.map,mergeDerive:!0,split:!0}),le({keys:D.current.keys,riskyTokens:D.current.tokens,merge:!0,map:D.current.map,mergeDerive:!0}),M.current.tokens=[],M.current.keys="",M.current.map={},D.current.tokens=[],D.current.keys="",D.current.map={}}),1e3),be=(0,o.useCallback)((Z=(0,r.A)((function*({accountId:e,networkId:t,dbAccount:n,allNetworkDataInit:r,customTokensRawData:o}){var a=yield k.A.serviceToken.fetchAccountTokens({dbAccount:n,networkId:t,accountId:e,flag:"home-token-list",isAllNetworks:!0,isManualRefresh:Ae.current,mergeTokens:!0,allNetworksAccountId:T?.id,allNetworksNetworkId:x?.id,saveToLocal:!0,customTokensRawData:o});if(!r&&a.isSameAllNetworksAccountData){var s,i,c,l,u=new K.A(0),d=new K.A(0);u=u.plus(null!=(s=a.tokens.fiatValue)?s:"0").plus(null!=(i=a.riskTokens.fiatValue)?i:"0").plus(null!=(c=a.smallBalanceTokens.fiatValue)?c:"0"),ce.c.markEnd("tokenListRefreshing_allNetworkRequests"),ke({initialized:!0,isRefreshing:!1}),we({isRefreshing:!1,initialized:!0}),T?.id&&(!p.A.isOthersAccount({accountId:T.id})||p.A.isOthersAccount({accountId:T.id})&&T?.createAtNetwork&&T.createAtNetwork===t)&&(d=u),ye({accountId:null!=(l=T?.id)?l:"",initialized:!0,worth:{[p.A.buildAccountValueKey({accountId:e,networkId:t})]:u.toFixed()},createAtNetworkWorth:d.toFixed(),merge:!0});var m=!!(yield k.A.serviceNetwork.getVaultSettings({networkId:t})).mergeDeriveAssetsEnabled;M.current.tokens=M.current.tokens.concat([...a.tokens.data,...a.smallBalanceTokens.data]),M.current.keys=`${M.current.keys}_${a.tokens.keys}`;var f=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},a.tokens.map),a.smallBalanceTokens.map);M.current.map=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},f),M.current.map),D.current.tokens=D.current.tokens.concat([...a.riskTokens.data]),D.current.keys=`${D.current.keys}_${a.riskTokens.keys}`,D.current.map=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},a.riskTokens.map),D.current.map),ie({tokens:f,merge:!0,mergeDerive:m}),pe({tokens:f,merge:!0,mergeDerive:m}),ue({tokens:a.riskTokens.map,merge:!0,mergeDerive:m}),a.allTokens&&(re({tokens:a.allTokens.map,merge:!0,mergeDerive:m}),te({keys:a.allTokens.keys,tokens:a.allTokens.data,map:a.allTokens.map,merge:!0,mergeDerive:m})),ve()}return Ae.current=!1,a})),function(e){return Z.apply(this,arguments)}),[T?.createAtNetwork,T?.id,x?.id,te,re,ue,pe,ie,we,ye,ve,ke]),Te=(0,o.useCallback)((function(){var e=(0,Ve.H7)();me({value:"0"}),te({tokens:e.allTokens.data,keys:e.allTokens.keys}),re({tokens:e.allTokens.map}),se({tokens:e.tokens.data,keys:e.tokens.keys}),ie({tokens:e.tokens.map}),de({smallBalanceTokens:e.smallBalanceTokens.data,keys:e.smallBalanceTokens.keys}),pe({tokens:e.smallBalanceTokens.map}),le({riskyTokens:e.riskTokens.data,keys:e.riskTokens.keys}),ue({tokens:e.riskTokens.map})}),[te,re,le,ue,de,pe,me,se,ie]),xe=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:m.GV.TOKENS,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),Ie=(0,o.useCallback)((function({accountId:e,networkId:t}){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:m.GV.TOKENS,accountId:null!=e?e:"",networkId:null!=t?t:""})}),[]),Se=(0,o.useCallback)((Q=(0,r.A)((function*({accountId:e,networkId:t,xpub:n,accountAddress:r,simpleDbLocalTokensRawData:o}){var a=ae.A.createPerf({name:ae.D.allNetwork__handleAllNetworkCacheRequests});a.markStart("getAccountLocalTokens",{networkId:t,accountAddress:r,rawDataExist:!!o});var s=yield k.A.serviceToken.getAccountLocalTokens({accountId:e,networkId:t,accountAddress:r,xpub:n,simpleDbLocalTokensRawData:o});a.markEnd("getAccountLocalTokens");var{tokenList:i,smallBalanceTokenList:c,riskyTokenList:l}=s;return a.done(),ee()(i)&&ee()(l)&&ee()(c)?null:TokenListContainer_objectSpread(TokenListContainer_objectSpread({},s),{},{tokenList:i,smallBalanceTokenList:c,riskyTokenList:l,accountId:e,networkId:t})})),function(e){return Q.apply(this,arguments)}),[]),je=(0,o.useCallback)((function({data:e,accountId:t,networkId:n}){ce.c.markStart("handleAllNetworkCacheData");var r,o,a,s=[],i=[],c={},l={};(e.forEach((function(e){s.push(...e.tokenList,...e.smallBalanceTokenList),i.push(...e.riskyTokenList),c=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},c),e.tokenListMap),l=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},l),{},{[p.A.buildAccountValueKey({accountId:e.accountId,networkId:e.networkId})]:e.tokenListValue})})),ie({tokens:c,merge:!0,mergeDerive:!0}),pe({tokens:c,merge:!0,mergeDerive:!0}),ue({tokens:c,merge:!0,mergeDerive:!0}),re({tokens:c,merge:!0,mergeDerive:!0}),se({keys:`${t}_${n}_local_all`,tokens:s,merge:!0,map:c,mergeDerive:!0,split:!0}),le({keys:`${t}_${n}_local_all`,riskyTokens:i,merge:!0,map:c,mergeDerive:!0}),te({keys:`${t}_${n}_local_all`,tokens:[...s,...i],map:c,merge:!0,mergeDerive:!0}),ee()(s)&&ee()(i))||(ye({accountId:null!=(r=T?.id)?r:"",initialized:!0,worth:l,createAtNetworkWorth:l[p.A.buildAccountValueKey({accountId:null!=(o=T?.id)?o:"",networkId:null!=(a=T?.createAtNetwork)?a:""})],updateAll:!0}),we({isRefreshing:!1,initialized:!0}),ce.c.markEnd("tokenListRefreshing_allNetworkCacheData"),ke({initialized:!0,isRefreshing:!1}),ce.c.markEnd("handleAllNetworkCacheData"))}),[T?.createAtNetwork,T?.id,te,re,le,ue,pe,se,ie,we,ye,ke]),Le=(0,o.useCallback)((function({accounts:e,allAccounts:t}){he({visibleCount:ne()(t,"networkId").length}),_(e)}),[he]),{run:He,result:Ne,isEmptyAccount:Oe}=useAllNetworkRequests({accountId:T?.id,networkId:x?.id,walletId:I?.id,isAllNetworks:x?.isAllNetworks,allNetworkRequests:be,allNetworkCacheRequests:Se,allNetworkCacheData:je,allNetworkAccountsData:Le,clearAllNetworkData:Te,onStarted:Ie,onFinished:xe,interval:200,shouldAlwaysFetch:N}),Ce=(0,o.useCallback)((0,r.A)((function*(){var e={tokens:[],keys:""},t={smallBalanceTokens:[],keys:""},n={riskyTokens:[],keys:""},r={},o={},a={},s={},i=new K.A(0),c=new K.A(0);if(Ne){var l;for(var u of Ne){var d,m,f,y,w,h,g=(yield k.A.serviceNetwork.getVaultSettings({networkId:null!=(d=u.networkId)?d:""})).mergeDeriveAssetsEnabled;e.tokens=(0,Ve.JW)({sourceTokens:u.tokens.data,targetTokens:e.tokens,mergeDeriveAssets:g}),e.keys=`${e.keys}_${u.tokens.keys}`,r=(0,Ve.bX)({sourceMap:u.tokens.map,targetMap:r,mergeDeriveAssets:g}),t.smallBalanceTokens=(0,Ve.JW)({sourceTokens:u.smallBalanceTokens.data,targetTokens:t.smallBalanceTokens,mergeDeriveAssets:g}),t.keys=`${t.keys}_${u.smallBalanceTokens.keys}`,o=(0,Ve.bX)({sourceMap:u.smallBalanceTokens.map,targetMap:o,mergeDeriveAssets:g}),n.riskyTokens=(0,Ve.JW)({sourceTokens:u.riskTokens.data,targetTokens:n.riskyTokens,mergeDeriveAssets:g}),n.riskyTokens=n.riskyTokens.concat(u.riskTokens.data),n.keys=`${n.keys}_${u.riskTokens.keys}`,a=(0,Ve.bX)({sourceMap:u.riskTokens.map,targetMap:a,mergeDeriveAssets:g});var A,v,b,x=new K.A(null!=(m=u.tokens.fiatValue)?m:"0").plus(null!=(f=u.riskTokens.fiatValue)?f:"0").plus(null!=(y=u.smallBalanceTokens.fiatValue)?y:"0");if(s=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},s),{},{[p.A.buildAccountValueKey({accountId:null!=(w=u.accountId)?w:"",networkId:null!=(h=u.networkId)?h:""})]:x.toFixed()}),T?.id&&(!p.A.isOthersAccount({accountId:T.id})||p.A.isOthersAccount({accountId:T.id})&&T?.createAtNetwork&&T.createAtNetwork===u.networkId))i=i.plus(null!=(A=u.tokens.fiatValue)?A:"0").plus(null!=(v=u.riskTokens.fiatValue)?v:"0").plus(null!=(b=u.smallBalanceTokens.fiatValue)?b:"0")}var I=TokenListContainer_objectSpread(TokenListContainer_objectSpread({},r),o),S=(0,Ve.LQ)({tokens:[...e.tokens,...t.smallBalanceTokens],map:I}),j=S.findIndex((function(e){var t;return new K.A(null!=(t=I[e.$key]?.fiatValue)?t:0).isZero()}));if(j>-1){var L=S.slice(0,j),H=S.slice(j);H=(0,Ve.q5)({tokens:H}),S=[...L,...H]}e.tokens=S.slice(0,oe.tr),t.smallBalanceTokens=S.slice(oe.tr),c=t.smallBalanceTokens.reduce((function(e,t){var n;return e.plus(null!=(n=I[t.$key].fiatValue)?n:"0")}),new K.A(0)),n.riskyTokens=(0,Ve.LQ)({tokens:n.riskyTokens,map:a}),ye({accountId:null!=(l=T?.id)?l:"",initialized:!0,updateAll:!0,worth:s,createAtNetworkWorth:i.toFixed()}),se(e),ie({tokens:I}),de(t),pe({tokens:I}),me({value:c.toFixed()}),le(n),ue({tokens:a}),te({keys:`${e.keys}_${t.keys}_${n.keys}`,tokens:[...e.tokens,...n.riskyTokens]}),re({tokens:TokenListContainer_objectSpread(TokenListContainer_objectSpread({},I),a)})}})),[T?.createAtNetwork,T?.id,Ne,te,re,le,ue,de,pe,me,se,ie,ye]);(0,o.useEffect)((function(){Ce()}),[Ce]),(0,o.useEffect)((function(){g&&ge()}),[g,ge]),(0,o.useEffect)((function(){var e,t=(e=(0,r.A)((function*({accountId:e,networkId:t,accountAddress:n,xpub:r}){if(fe(""),k.A.serviceToken.updateCurrentAccount({networkId:t,accountId:e}),t===ze.onekeyall)return ce.c.markStart("tokenListRefreshing_1"),ke({initialized:!1,isRefreshing:!0}),void we({initialized:!1,isRefreshing:!0});var o=yield k.A.serviceToken.getAccountLocalTokens({accountId:e,networkId:t,accountAddress:n,xpub:r}),{tokenList:a,smallBalanceTokenList:s,riskyTokenList:i,tokenListMap:c,tokenListValue:l}=o;ee()(a)&&ee()(s)&&ee()(i)?(ce.c.markStart("tokenListRefreshing_2"),ke({initialized:!1,isRefreshing:!0}),we({initialized:!1,isRefreshing:!0}),t!==ze.onekeyall&&Te()):(ye({accountId:e,initialized:!0,worth:{[p.A.buildAccountValueKey({accountId:e,networkId:t})]:l},createAtNetworkWorth:l,merge:!1}),se({tokens:a,keys:`${e}_${t}_local`}),ie({tokens:c}),de({smallBalanceTokens:s,keys:`${e}_${t}_local`}),pe({tokens:c}),le({riskyTokens:i,keys:`${e}_${t}_local`}),ue({tokens:c}),te({keys:`${e}_${t}_local`,tokens:[...a,...s,...i]}),re({tokens:c}),we({isRefreshing:!1,initialized:!0}),ce.c.markEnd("tokenListRefreshing_initTokenListData"),ke({initialized:!0,isRefreshing:!1}),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:m.GV.TOKENS,accountId:e,networkId:t}))})),function initTokenListData(t){return e.apply(this,arguments)});T?.id&&x?.id&&I?.id&&t({accountId:T.id,networkId:x.id,accountAddress:T.address,xpub:T.xpubSegwit||T.xpub})}),[T?.address,T?.id,T?.xpub,T?.xpubSegwit,Te,x?.id,te,re,le,ue,de,pe,se,ie,we,ye,fe,ke,I?.id]);var Re,Pe=(0,o.useCallback)((function(e){var t,n;T&&x&&I&&L&&Y.pushModal(E.ry.MainModal,{screen:E.kZ.TokenDetails,params:{accountId:null!=(t=e.accountId)?t:T.id,networkId:null!=(n=e.networkId)?n:x.id,walletId:I.id,deriveInfo:L,deriveType:H,tokenInfo:e,isAllNetworks:x.isAllNetworks}})}),[T,L,H,Y,x,I]),Ee=(0,o.useMemo)((function(){return!$?.disabledSendAction&&I?.type!==B.Hk}),[$?.disabledSendAction,I?.type]),Me=(0,o.useCallback)((function(){Ae.current=!0,He({alwaysSetState:!0})}),[He]),De=(0,o.useCallback)((Re=(0,r.A)((function*(e){for(var{accountId:t,networkId:n}of e)yield be({accountId:t,networkId:n,allNetworkDataInit:!1})})),function(e){return Re.apply(this,arguments)}),[be]);return(0,A.yk)((0,r.A)((function*(){if(T&&x&&x.isAllNetworks&&!Fe()(C)){var e=yield k.A.serviceHistory.getAllNetworksPendingTxs({accountId:T.id,networkId:x.id,allNetworkAccounts:C});if(!ee()(e)){var t=yield k.A.serviceHistory.fetchAccountHistory({accountId:T.id,networkId:x.id});t.accountsWithChangedPendingTxs.length>0&&De(t.accountsWithChangedPendingTxs)}}})),[T,C,De,x],{overrideIsFocused:function(e){return e&&h},debounced:oe.EI,pollingInterval:oe.fu}),(0,o.useEffect)((function(){var refresh=function(e){x?.isAllNetworks?e?.accounts?De(e.accounts):Me():ge()},fn=function(){h&&refresh(void 0)};return u.iL.on(u.Tu.NetworkDeriveTypeChanged,fn),u.iL.on(u.Tu.RefreshTokenList,refresh),u.iL.on(u.Tu.AccountDataUpdate,fn),function(){u.iL.off(u.Tu.RefreshTokenList,refresh),u.iL.off(u.Tu.AccountDataUpdate,fn),u.iL.off(u.Tu.NetworkDeriveTypeChanged,fn)}}),[Me,De,h,x?.isAllNetworks,ge,He]),(0,o.useEffect)((function(){Oe&&(ce.c.markEnd("tokenListRefreshing_emptyAccount"),ke({initialized:!0,isRefreshing:!1}),we({initialized:!0,isRefreshing:!1}))}),[Oe,we,ke]),(0,y.jsx)(We.x,TokenListContainer_objectSpread(TokenListContainer_objectSpread({withHeader:!0,withFooter:!0,withPrice:!0,inTabList:!0,hideValue:!0,withBuyAndReceive:Ee,isBuyTokenSupported:U,onBuyToken:W,onReceiveToken:z,manageTokenEnabled:X,onManageToken:q,onPressToken:Pe,isAllNetworks:x?.isAllNetworks},G.gtLg&&{tableLayout:!0}),{},{"data-sentry-element":"TokenListView","data-sentry-component":"TokenListContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/TokenListContainer.tsx"}))}var Ke=(0,o.memo)((function(e){var t,{activeAccount:{account:n}}=(0,v.LH)({num:0});return(0,y.jsx)(Ue.m,{accountId:null!=(t=n?.id)?t:"",children:(0,y.jsx)(TokenListContainer,TokenListContainer_objectSpread({showWalletActions:!0},e))})}));Ke.displayName="TokenListContainerWithProvider";var qe=n(232471),Xe=n(124155),Ge=n(616552);function TxHistoryContainer_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function TxHistoryContainer_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?TxHistoryContainer_ownKeys(Object(n),!0).forEach((function(t){(0,T.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TxHistoryContainer_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ye=(0,o.memo)((0,Ge.UK)((function TxHistoryListContainer(e){var t,{isFocused:n,isHeaderRefreshing:a,setIsHeaderRefreshing:s}=(0,c.useTabIsRefreshingFocused)(),{updateSearchKey:i}=(0,Ge.n8)().current,{updateAllNetworksState:l}=(0,J.Lu)().current,[d,p]=(0,o.useState)([]),[f,w]=(0,o.useState)({initialized:!1,isRefreshing:!1}),h=(0,o.useRef)(!1),g=(0,c.useMedia)(),b=(0,R.A)(),{activeAccount:{account:T,network:x,wallet:I}}=(0,v.LH)({num:0}),S=(0,o.useCallback)((t=(0,r.A)((function*(e){if(T&&x){if(e.decodedTx.status===qe.Y1.Pending&&e.isLocalCreated){var t=yield k.A.serviceHistory.getLocalHistoryTxById({accountId:e.decodedTx.accountId,networkId:e.decodedTx.networkId,historyId:e.id});if(!t||t.replacedNextId)return}b.pushModal(E.ry.MainModal,{screen:E.kZ.HistoryDetails,params:{networkId:e.decodedTx.networkId,accountId:e.decodedTx.accountId,historyTx:e,isAllNetworks:x.isAllNetworks}})}})),function(e){return t.apply(this,arguments)}),[T,b,x]),j=(0,o.useRef)(!1),{run:L}=(0,A.yk)((0,r.A)((function*(){if(T&&x){u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!0,type:m.GV.HISTORY,accountId:T.id,networkId:x.id});var e=yield k.A.serviceHistory.fetchAccountHistory({accountId:T.id,networkId:x.id,isManualRefresh:j.current});l({visibleCount:ne()(e.allAccounts,"networkId").length}),w({initialized:!0,isRefreshing:!1}),s(!1),p(e.txs),u.iL.emit(u.Tu.TabListStateUpdate,{isRefreshing:!1,type:m.GV.HISTORY,accountId:T.id,networkId:x.id}),e.accountsWithChangedPendingTxs.length>0&&u.iL.emit(u.Tu.RefreshTokenList,{accounts:e.accountsWithChangedPendingTxs}),j.current=!1}})),[T,x,s,l],{overrideIsFocused:function(e){return e&&n},debounced:oe.EI,pollingInterval:oe.fu});return(0,o.useEffect)((function(){var e,t=(e=(0,r.A)((function*(e,t){var n=yield k.A.serviceHistory.getAccountsLocalHistoryTxs({accountId:e,networkId:t});ee()(n)?w({initialized:!1,isRefreshing:!0}):(p(n),w({initialized:!0,isRefreshing:!1})),i(""),h.current=!1})),function initHistoryState(t,n){return e.apply(this,arguments)});T?.id&&x?.id&&I?.id&&t(T.id,x.id)}),[T?.id,x?.id,i,I?.id]),(0,o.useEffect)((function(){a&&L()}),[a,L]),(0,o.useEffect)((function(){var refresh=function(){n&&(j.current=!0,L())},clearCallback=function(){return p((function(e){return e.filter((function(e){return e.decodedTx.status!==qe.Y1.Pending}))}))};return u.iL.on(u.Tu.ClearLocalHistoryPendingTxs,clearCallback),u.iL.on(u.Tu.AccountDataUpdate,refresh),u.iL.on(u.Tu.NetworkDeriveTypeChanged,refresh),function(){u.iL.off(u.Tu.ClearLocalHistoryPendingTxs,clearCallback),u.iL.off(u.Tu.AccountDataUpdate,refresh),u.iL.off(u.Tu.NetworkDeriveTypeChanged,refresh)}}),[n,L]),(0,o.useEffect)((function(){var reloadCallback=function(){return L({alwaysSetState:!0})},fn=function(){n&&L()};return u.iL.on(u.Tu.AccountDataUpdate,fn),u.iL.on(u.Tu.HistoryTxStatusChanged,reloadCallback),function(){u.iL.off(u.Tu.HistoryTxStatusChanged,reloadCallback),u.iL.off(u.Tu.AccountDataUpdate,fn)}}),[n,L]),(0,y.jsx)(Xe.q,TxHistoryContainer_objectSpread(TxHistoryContainer_objectSpread({showIcon:!0,inTabList:!0,hideValue:!0,data:null!=d?d:[],onPressHistory:S,showHeader:!0,isLoading:f.isRefreshing,initialized:f.initialized},g.gtLg&&{tableLayout:!0}),{},{"data-sentry-element":"TxHistoryListView","data-sentry-component":"TxHistoryListContainer","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Home/pages/TxHistoryContainer.tsx"}))})));const Je=function LNHardwareWalletAuth({children:e,accountId:t,networkId:n}){var s=(0,a.A)(),[i,l]=(0,o.useState)(!1),[u,p]=(0,o.useState)(!1),{result:m,run:f}=(0,A.yk)((0,r.A)((function*(){try{return yield k.A.serviceLightning.checkAuth({accountId:t,networkId:n}),!0}catch{return!1}finally{l(!0)}})),[n,t]),w=(0,o.useCallback)((0,r.A)((function*(){p(!0);try{yield k.A.serviceLightning.exchangeToken({networkId:n,accountId:t}),setTimeout((function(){f()}),200)}catch(e){c.Toast.error({title:s.formatMessage({id:d.ETranslations.ln_authorize_access_network_error})})}finally{p(!1)}})),[n,t,s,f]);return i?m?(0,y.jsx)(y.Fragment,{children:e}):(0,y.jsxs)(c.Stack,{testID:"LNHardwareAuth",w:"100%",h:"100%","data-sentry-element":"Stack","data-sentry-component":"LNHardwareWalletAuth","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/LightningNetwork/components/LNHardwareWalletAuth.tsx",children:[(0,y.jsx)(O.p,{"data-sentry-element":"HomeTokenListProviderMirror","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/LightningNetwork/components/LNHardwareWalletAuth.tsx",children:(0,y.jsx)(c.Stack,{testID:"Wallet-Tab-Header",p:"$5","data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/LightningNetwork/components/LNHardwareWalletAuth.tsx",children:(0,y.jsx)(H,{mb:"$2.5","data-sentry-element":"HomeSelector","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/LightningNetwork/components/LNHardwareWalletAuth.tsx"})})}),(0,y.jsx)(c.Stack,{flex:1,testID:"LNHardware",justifyContent:"center",alignItems:"center","data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/LightningNetwork/components/LNHardwareWalletAuth.tsx",children:(0,y.jsx)(c.Empty,{icon:"PasswordOutline",title:s.formatMessage({id:d.ETranslations.ln_authorize_access}),description:s.formatMessage({id:d.ETranslations.ln_authorize_access_desc}),buttonProps:{children:s.formatMessage({id:d.ETranslations.global_connect_hardware_wallet}),onPress:function(){w()},loading:u},"data-sentry-element":"Empty","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/LightningNetwork/components/LNHardwareWalletAuth.tsx"})})]}):(0,y.jsx)(c.Stack,{w:"100%",h:"100%",alignItems:"center",justifyContent:"center",children:(0,y.jsx)(c.Spinner,{size:"large"})})};var Ze=n(553083);const Qe=function WalletContentWithAuth({networkId:e,accountId:t,children:n}){return Ze.Ay.isLightningNetworkByNetworkId(e)&&p.A.isHwAccount({accountId:t})?(0,y.jsx)(Je,{networkId:e,accountId:t,children:n}):n};var et;function HomePageView({onPressHide:e,sceneName:t}){var n,g,{screenWidth:T,pageWidth:x}=(0,N.A)();null==et&&(et=new s.A.Value(x)),(0,o.useEffect)((function(){et&&s.A.timing(et,{toValue:x,duration:400,easing:i.A.inOut(i.A.quad),useNativeDriver:!1}).start()}),[x]);var I=(0,a.A)(),{activeAccount:{account:S,accountName:j,network:L,deriveInfo:O,wallet:C,ready:_,device:R}}=(0,v.LH)({num:0}),[P,E]=(O?.labelKey?I.formatMessage({id:O?.labelKey}):n=O?.label,(0,o.useState)(!1)),M=(0,A.yk)((0,r.A)((function*(){var e;return L?k.A.serviceNetwork.getVaultSettings({networkId:null!=(e=L?.id)?e:""}):Promise.resolve(void 0)})),[L]).result,D=M?.NFTEnabled&&(0,l.cN)().includes(null!=(g=L?.id)?g:""),F=M?.validationRequired,B=M?.softwareAccountDisabled,$=M?.supportedDeviceTypes,V=M?.watchingAccountEnabled,W=(0,o.useMemo)((function(){return[{title:I.formatMessage({id:d.ETranslations.global_crypto}),page:(0,o.memo)(Ke,(function(){return!0}))},D?{title:I.formatMessage({id:d.ETranslations.global_nft}),page:(0,o.memo)(Me,(function(){return!0}))}:null,{title:I.formatMessage({id:d.ETranslations.global_history}),page:(0,o.memo)(Ye,(function(){return!0}))}].filter(Boolean)}),[I,S?.id,L?.id,D]),U=(0,o.useCallback)((function(){u.iL.emit(u.Tu.AccountDataUpdate,void 0)}),[]),z=(0,o.useCallback)((function(){return(0,y.jsx)(c.Tab,{disableRefresh:!0,data:W,ListHeaderComponent:(0,y.jsx)(HomeHeaderContainer,{}),initialScrollIndex:0,initialHeaderHeight:220,contentItemWidth:et,contentWidth:T,showsVerticalScrollIndicator:!1,onRefresh:U})}),[W,T,U]);(0,o.useEffect)((function(){c.Icon.prefetch("CloudOffOutline")}),[]);var K=(0,o.useCallback)((function(){var e,t,n,r,o;return B&&p.A.isHdWallet({walletId:null!=(e=C?.id)?e:""})||$&&R?.deviceType&&!$.includes(R?.deviceType)?(0,y.jsx)(HomeSupportedWallet,{supportedDeviceTypes:$,watchingAccountEnabled:V}):S?F?(0,y.jsx)(Qe,{networkId:null!=(r=L?.id)?r:"",accountId:null!=(o=S?.id)?o:"",children:(0,y.jsx)(y.Fragment,{children:z()})}):(0,y.jsx)(y.Fragment,{children:z()}):(0,y.jsxs)(c.YStack,{height:"100%",children:[(0,y.jsx)(H,{padding:"$5"}),(0,y.jsx)(c.Stack,{flex:1,justifyContent:"center",children:(0,y.jsx)(f.TP,{autoCreateAddress:!0,name:j,chain:null!=(t=L?.name)?t:"",type:null!=(n=O?.labelKey?I.formatMessage({id:O?.labelKey}):O?.label)?n:""})})]})}),[B,C?.id,$,R?.deviceType,S,F,z,V,j,L?.name,L?.id,O?.labelKey,O?.label,I]),q=(0,o.useCallback)((function(){if(!_)return(0,y.jsx)(h.i,{showHeaderRight:!0,sceneName:t});var e=(0,y.jsx)(c.Stack,{h:"100%",justifyContent:"center",children:(0,y.jsx)(f.Bl,{})});return C&&(e=K()),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(h.i,{showHeaderRight:!0,sceneName:t}),(0,y.jsxs)(c.Page.Body,{children:[(0,y.jsx)(w,{}),t===m.Zs.home?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(UpdateReminder,{}),(0,y.jsx)(b.a,{})]}):null,e]})]})}),[_,C,t,K]);return(0,o.useMemo)((function(){return(0,y.jsx)(c.Page,{fullPage:!0,children:q()})}),[q])}},669617:(e,t,n)=>{n.d(t,{D_:()=>getFilteredNftsBySearchKey,Le:()=>generateUploadNFTParams});var r=n(324586),o=n(586330),a=n(37754),s=n(723958),i=n(183758),c=n(432104),l=n(227428),u=n(606777),d=n(231282),p=n(901048).Buffer;function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function getFilteredNftsBySearchKey({nfts:e,searchKey:t}){return!t||t.length<l.NZ?e:(t=t.trim().toLowerCase(),e.filter((function(e){return e.collectionAddress?.toLowerCase()===t||e.collectionName?.toLowerCase().includes(t)||e.metadata?.name?.toLowerCase().includes(t)})))}var getImageSize=function(e){return new Promise((function(t,n){c.A.getSize(e,(function(e,n){t({width:e,height:n})}),(function(e){return n(e)}))}))};var m,k=(m=(0,o.A)((function*(e,t,n,r,o,a){var c;if(e){var l=r>o,u=r===o,d=[];if(a?d.push({resize:{width:l?void 0:t,height:l?n:void 0}}):d.push({resize:{width:t}}),a&&!u)if(l){var m=function getOriginX(e,t,n,r){var o=Math.ceil(r/t*e);return o<=n?null:Math.ceil(Math.ceil(o/2)-Math.ceil(n/2))}(r,o,t,n);null!==m&&d.push({crop:{height:n,width:t,originX:m,originY:0}})}else{var k=function getOriginY(e,t,n,r){var o=Math.ceil(n/e*t);return o<=r?null:Math.ceil(Math.ceil(o/2)-Math.ceil(r/2))}(r,o,t,n);null!==k&&d.push({crop:{height:n,width:t,originX:0,originY:k}})}var f=yield(0,s.rE)(e,d,{compress:.9,format:i.$.JPEG,base64:!0}),y=p.from(null!=(c=f.base64)?c:"","base64"),w=new Uint8Array(y);return _objectSpread(_objectSpread({},f),{},{arrayBuffer:w})}})),function compressNFT(e,t,n,r,o,a){return m.apply(this,arguments)});function generateUploadNFTParams(e){return _generateUploadNFTParams.apply(this,arguments)}function _generateUploadNFTParams(){return(_generateUploadNFTParams=(0,o.A)((function*({imageUri:e,metadata:t,deviceType:n}){var{width:r,height:o}=yield getImageSize(e),s=yield d.A.getBase64FromImageUri({uri:e});if(!s)throw new Error(`Failed to get base64 from image uri: ${e}`);var i=yield k(s,480,800,r,o,!1),c="touch"===n?238:226,l="touch"===n?238:226,m=yield k(s,c,l,r,o,!0);if(i?.arrayBuffer||m?.arrayBuffer){var f=_objectSpread({},t),y=p.from(JSON.stringify(f));y.length>2048&&(f.subheader="",y=p.from(JSON.stringify(f)));var w=u.A.bytesToHex(y);return{resType:a.ResourceType.Nft,suffix:"jpg",dataHex:u.A.bytesToHex(i?.arrayBuffer),thumbnailDataHex:u.A.bytesToHex(m?.arrayBuffer),nftMetaData:w}}}))).apply(this,arguments)}}}]);
//# sourceMappingURL=65613.402d4ebe4e.chunk.js.map
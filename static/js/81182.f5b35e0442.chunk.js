!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e17a68d7-18e6-4fca-97b7-55e8f055dbaa",e._sentryDebugIdIdentifier="sentry-dbid-e17a68d7-18e6-4fca-97b7-55e8f055dbaa")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"5.5.1 (2024123091)"},(self.webpackChunkweb=self.webpackChunkweb||[]).push([[81182],{424403:(e,t,o)=>{o.d(t,{KR:()=>useCheckAccountExist,Mo:()=>useAccountInfoForManageToken,YF:()=>useAddToken,yT:()=>useAddTokenForm});var n=o(586330),r=o(514041),s=o(241440),a=o(578104),d=o(490343),i=o(625931),c=o(553083),l=o(643087),u=o(911998);function useAddTokenForm({token:e,networkId:t}){var o=c.Ay.isAllNetwork({networkId:t}),n=(0,r.useCallback)((function(){return e&&e.networkId?e.networkId:o?(0,i.V)().eth:t}),[o,t,e]),a=(0,d.useForm)({values:{networkId:n(),contractAddress:e?.address||"",symbol:e?.symbol||"",decimals:e?.decimals?new s.A(e.decimals).toString():""},mode:"onChange",reValidateMode:"onBlur"}),l=a.watch("networkId"),u=a.watch("contractAddress"),m=a.watch("symbol"),p=a.watch("decimals"),[k,f]=(0,r.useState)(!1),[w,g]=(0,r.useState)(!1),y=(0,r.useRef)(!0),A=(0,r.useCallback)((function(t){y.current||(e?.address||u)&&f(t)}),[u,e?.address]);return(0,r.useEffect)((function(){y.current?y.current=!1:a.trigger("contractAddress")}),[k,a]),{form:a,isEmptyContract:k,setIsEmptyContractState:A,selectedNetworkIdValue:l,contractAddressValue:u,symbolValue:m,decimalsValue:p,isSymbolEditable:w,setIsSymbolEditable:g}}function useAddToken({token:e,walletId:t,networkId:o,form:d,selectedNetworkIdValue:i,contractAddressValue:c,setIsEmptyContractState:m,setIsSymbolEditable:p}){var k,{result:f}=(0,u.yk)((0,n.A)((function*(){var t=(yield l.A.serviceNetwork.getCustomTokenEnabledNetworks({currentNetworkId:o})).map((function(e){return e.id})),n=yield l.A.serviceNetwork.getNetwork({networkId:o});return e?.networkId&&!t.includes(e.networkId)&&t.push(e.networkId),{networkIds:t,network:n}})),[o,e?.networkId]),w=(0,r.useRef)(),g=(0,a.YQ)((k=(0,n.A)((function*(o){var n;if(!e&&!o.value.trim())return d.setValue("symbol",""),d.setValue("decimals",""),void m(!0);var r=yield l.A.serviceCustomToken.searchTokenByContractAddress({walletId:t,networkId:o.networkId,contractAddress:o.value.trim(),isNative:null!=(n=e?.isNative)&&n});if(Array.isArray(r)&&r.length>0&&r[0]?.info){var[a]=r,i=a.info.symbol?.trim();i?(d.setValue("symbol",i),p(!1)):p(!0),d.setValue("decimals",new s.A(a.info.decimals).toString()),w.current=a.info,m(!1)}else d.setValue("symbol",""),p(!1),d.setValue("decimals",""),m(!0)})),function(e){return k.apply(this,arguments)}),300);return(0,r.useEffect)((function(){g({value:c,networkId:i})}),[c,i,g]),{availableNetworks:f,searchedTokenRef:w}}function useAccountInfoForManageToken(){var e,t=(0,r.useCallback)((e=(0,n.A)((function*({accountId:e,networkId:t,isOthersWallet:o,indexedAccountId:n,deriveType:r,selectedNetworkId:s}){var{serviceAccount:a}=l.A,d=!1,i="";try{i=o?(yield a.getAccount({accountId:e,networkId:t})).id:(yield a.getNetworkAccount({accountId:void 0,indexedAccountId:n,networkId:s,deriveType:r})).id,d=!0}catch(e){d=!1}return{hasExistAccountFlag:d,accountIdForNetwork:i}})),function(t){return e.apply(this,arguments)}),[]);return{findAccountInfoForNetwork:t}}function useCheckAccountExist({accountId:e,networkId:t,isOthersWallet:o,indexedAccountId:s,deriveType:a,selectedNetworkIdValue:d}){var{findAccountInfoForNetwork:i}=useAccountInfoForManageToken(),c=(0,r.useCallback)((0,n.A)((function*(){return i({accountId:e,networkId:t,isOthersWallet:o,indexedAccountId:s,deriveType:a,selectedNetworkId:d})})),[e,s,t,o,a,d,i]),{result:l,run:m}=(0,u.yk)((0,n.A)((function*(){var{hasExistAccountFlag:e}=yield c();return e})),[c]);return{hasExistAccount:l,runCheckAccountExist:m,checkAccountIsExist:c}}},281182:(e,t,o)=>{o.r(t),o.d(t,{default:()=>x});var n=o(586330),r=o(324586),s=o(514041),a=o(654266),d=o(241440),i=o(908867),c=o(490343),l=o(904121),u=o(525603),m=o(796895),p=o(24284),k=o(507140),f=o(334439),w=o(553083),g=o(714191),y=o(643087),A=o(414375),b=o(911998),I=o(980342),h=o(424403),v=o(831085);function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(o),!0).forEach((function(t){(0,r.A)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function CreateAddressButton(e){var t=(0,i.A)();return(0,v.jsx)(c.Button,_objectSpread(_objectSpread({$md:{flexGrow:1,flexBasis:0,size:"large"},variant:"primary"},e),{},{"data-sentry-element":"Button","data-sentry-component":"CreateAddressButton","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:t.formatMessage({id:f.ETranslations.global_create_address})}))}function AddCustomTokenModal(){var e,t,o=(0,i.A)(),r=(0,a.lq)(),{walletId:g,networkId:x,indexedAccountId:_,accountId:T,isOthersWallet:C,deriveType:M,token:E,onSuccess:j}=r.params,{$sourceInfo:S,walletId:N,networkId:$,indexedAccountId:F,accountId:O,isOthersWallet:V,deriveType:D,token:P,onSuccess:z}=(0,p.A)(),L=(0,m.A)({id:null!=(e=S?.id)?e:"",closeWindowAfterResolved:!0}),R=null!=N?N:g,B=null!=$?$:x,W=null!=F?F:_,q=null!=O?O:T,H=null!=V?V:C,K=null!=D?D:M,Y=null!=P?P:E,Z=null!=z?z:j,G=w.Ay.isAllNetwork({networkId:B}),{form:J,isEmptyContract:Q,setIsEmptyContractState:X,selectedNetworkIdValue:U,contractAddressValue:ee,symbolValue:te,decimalsValue:oe,isSymbolEditable:ne,setIsSymbolEditable:re}=(0,h.yT)({token:Y,networkId:B}),{hasExistAccount:se,runCheckAccountExist:ae,checkAccountIsExist:de}=(0,h.KR)({accountId:q,networkId:B,isOthersWallet:H,indexedAccountId:W,deriveType:K,selectedNetworkIdValue:U}),{availableNetworks:ie,searchedTokenRef:ce}=(0,h.YF)({token:Y,walletId:R,networkId:B,form:J,selectedNetworkIdValue:U,contractAddressValue:ee,setIsEmptyContractState:X,setIsSymbolEditable:re,checkAccountIsExist:de}),{result:le}=(0,b.yk)((function(){return y.A.serviceNetwork.getVaultSettings({networkId:U})}),[U]),[ue,me]=(0,s.useState)(!1),pe=(0,s.useMemo)((function(){return!se||(!!Q||(!te||!new d.A(oe).isInteger()||!!ue))}),[te,oe,Q,ue,se]),ke=(0,s.useCallback)((t=(0,n.A)((function*(e){me(!0);var{hasExistAccountFlag:t,accountIdForNetwork:n}=yield de();if(!t)return c.Toast.error({title:"Account not exist"}),void L.reject();var r=J.getValues(),{contractAddress:s,symbol:a,decimals:i}=r;if(!s&&!Y?.isNative)return me(!1),c.Toast.error({title:o.formatMessage({id:f.ETranslations.manger_token_custom_token_address_required})}),void L.reject({error:new k.oZ({key:f.ETranslations.manger_token_custom_token_address_required})});if(!a||!new d.A(i).isInteger())return me(!1),c.Toast.error({title:o.formatMessage({id:f.ETranslations.send_engine_incorrect_address})}),void L.reject({error:new k.oZ({key:f.ETranslations.send_engine_incorrect_address})});try{var l,u=_objectSpread(_objectSpread({address:s},ce.current),{},{symbol:a,decimals:new d.A(i).toNumber(),accountId:n,networkId:U,allNetworkAccountId:G?q:void 0,name:ce.current?.name||a||"",isNative:null!=(l=ce.current?.isNative)&&l,$key:`${U}_${s}`});yield y.A.serviceCustomToken.activateToken({accountId:n,networkId:U,token:u}),yield y.A.serviceCustomToken.addCustomToken({token:u})}finally{me(!1)}c.Toast.success({title:o.formatMessage({id:f.ETranslations.address_book_add_address_toast_add_success})}),setTimeout((function(){L.resolve(),Z?.(),e?.()}),300)})),function(e){return t.apply(this,arguments)}),[J,de,U,Y?.isNative,o,Z,G,q,ce,L]),fe=(0,s.useCallback)((function(){var e;return G?(0,v.jsx)(c.Form.Field,{label:o.formatMessage({id:f.ETranslations.global_chain}),name:"networkId",children:(0,v.jsx)(l.YS,{networkIds:ie?.networkIds})}):(0,v.jsx)(c.Form.Field,{label:o.formatMessage({id:f.ETranslations.global_network}),name:"networkId",children:(0,v.jsxs)(c.Stack,{userSelect:"none",flexDirection:"row",alignItems:"center",borderRadius:"$3",borderWidth:1,borderCurve:"continuous",borderColor:"$borderStrong",px:"$3",py:"$2.5",$gtMd:{borderRadius:"$2",py:"$2"},testID:"network-selector-input",children:[(0,v.jsx)(A.um,{networkId:B,size:"$6"}),(0,v.jsx)(c.SizableText,{testID:"network-selector-input-text",px:14,flex:1,size:"$bodyLg",children:null!=(e=ie?.network.name)?e:""})]})})}),[ie,o,G,B]),we=(0,I.z)(L);return(0,v.jsxs)(c.Page,{onClose:we,"data-sentry-element":"Page","data-sentry-component":"AddCustomTokenModal","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:[(0,v.jsx)(c.Page.Header,{title:o.formatMessage({id:f.ETranslations.manage_token_custom_token_title}),"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx"}),(0,v.jsx)(c.Page.Body,{px:"$5","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:(0,v.jsxs)(c.Form,{form:J,"data-sentry-element":"Form","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:[fe(),le?.isNativeTokenContractAddressEmpty?null:(0,v.jsx)(c.Form.Field,{label:o.formatMessage({id:f.ETranslations.manage_token_custom_token_contract_address}),rules:{validate:function(){if(Q)return o.formatMessage({id:f.ETranslations.Token_manage_custom_token_address_faild})}},name:"contractAddress",children:(0,v.jsx)(c.Input,{size:"large",$gtMd:{size:"medium"},editable:!Y?.isNative})}),(0,v.jsx)(c.Form.Field,{label:o.formatMessage({id:f.ETranslations.manage_token_custom_token_symbol}),rules:{required:!!ne&&{value:!0,message:o.formatMessage({id:f.ETranslations.manage_token_token_required})}},name:"symbol","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:(0,v.jsx)(c.Input,{size:"large",$gtMd:{size:"medium"},editable:ne,"data-sentry-element":"Input","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx"})}),(0,v.jsx)(c.Form.Field,{label:o.formatMessage({id:f.ETranslations.manage_token_custom_token_decimal}),name:"decimals","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:(0,v.jsx)(c.Input,{size:"large",$gtMd:{size:"medium"},editable:!1,"data-sentry-element":"Input","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx"})})]})}),(0,v.jsx)(c.Page.Footer,{onConfirmText:o.formatMessage({id:f.ETranslations.manage_token_custom_token_add_btn}),onConfirm:ke,confirmButtonProps:{loading:ue,disabled:pe},"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:se?void 0:(0,v.jsx)(c.Stack,{testID:"add-custom-token-modal-footer",p:"$5",bg:"$bgApp",$md:{height:130},children:(0,v.jsxs)(c.Stack,{flex:1,$gtMd:{gap:"$2.5",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},$md:{gap:"$5"},children:[(0,v.jsxs)(c.XStack,{alignItems:"center",gap:"$2",children:[(0,v.jsx)(c.SizableText,{size:"$bodyMdMedium",color:"$text",children:o.formatMessage({id:f.ETranslations.manage_token_custom_token_create_address})}),(0,v.jsx)(c.Icon,{name:"ArrowRightOutline",color:"$iconSubdued",size:"$5"}),(0,v.jsx)(c.SizableText,{size:"$bodyMdMedium",color:"$textSubdued",children:o.formatMessage({id:f.ETranslations.manage_token_custom_token_add})})]}),(0,v.jsx)(u.J,{num:0,account:{walletId:R,indexedAccountId:W,networkId:U,deriveType:K},buttonRender:CreateAddressButton,onCreateDone:function(){setTimeout((function(){ae()}))}})]})})})]})}const x=function AddCustomTokenModalWithMirror(){return(0,v.jsx)(l.b8,{config:{sceneName:g.Zs.home},enabledNum:[0],"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"AddCustomTokenModalWithMirror","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx",children:(0,v.jsx)(AddCustomTokenModal,{"data-sentry-element":"AddCustomTokenModal","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/AssetList/pages/AddCustomTokenModal.tsx"})})}},980342:(e,t,o)=>{o.d(t,{A:()=>a,z:()=>useDappCloseHandler});var n=o(490343),r=o(42484),s=o(831085);function useDappCloseHandler(e,t){return function(o){o?.flag!==r.nd.Confirmed&&e.reject(),"function"==typeof t&&t(o)}}const a=function DappOpenModalPage({children:e,onClose:t,dappApprove:o}){var r=useDappCloseHandler(o,t);return(0,s.jsxs)(n.Page,{scrollEnabled:!0,onClose:r,"data-sentry-element":"Page","data-sentry-component":"DappOpenModalPage","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DappOpenModalPage.tsx",children:[(0,s.jsx)(n.Page.Header,{headerShown:!1,"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/DAppConnection/pages/DappOpenModalPage.tsx"}),e]})}}}]);
//# sourceMappingURL=81182.f5b35e0442.chunk.js.map
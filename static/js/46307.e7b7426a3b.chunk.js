!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="eec41f9d-9ff6-4313-80a3-8330af19131a",e._sentryDebugIdIdentifier="sentry-dbid-eec41f9d-9ff6-4313-80a3-8330af19131a")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"5.5.1 (2024123091)"},(self.webpackChunkweb=self.webpackChunkweb||[]).push([[46307],{123890:(e,t,n)=>{n.d(t,{z6:()=>useLazyMarketTradeActions,zl:()=>useMarketTradeActions,KY:()=>useMarketTradeNetwork,Hr:()=>useMarketTradeNetworkId});var a=n(324586),o=n(586330),r=n(514041),s=n(908867),c=n(490343),i=n(334439),d=n(296827),p=n(193068),l=n(180706),u=n(628380),f=n(117746),w=n(584186),y=n(317192),k=n(657355),m=n(625931),b=(0,k.EO)((function(e){var t=(0,m.V)();if("btc"===e)return t.btc})),S=n(619390),g=n(643087),v=n(498356),M=n(162616),A=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var useMarketTradeNetwork=function(e){var{detailPlatforms:t,platforms:n={}}=e||{};return(0,r.useMemo)((function(){if(t){var e=Object.values(t),a=e.find((function(e){return e.isNative}));if(a)return a;var o=Object.values(n)[0],r=e.find((function(e){return e.tokenAddress===o}));return null!=r?r:e[0]}}),[t,n])},useMarketTradeNetworkId=function(e,t){return(0,r.useMemo)((function(){var{onekeyNetworkId:n}=e||{};return null!=n?n:b(t)}),[e,t])},useMarketTradeActions=function(e){var t,n,{symbol:a="",name:w}=e||{},k=(0,s.A)(),m=useMarketTradeNetwork(e),b=useMarketTradeNetworkId(m,a),h=(0,v.A)(),{activeAccount:I}=(0,M.LH)({num:0}),j=(0,r.useMemo)((function(){var e;return null!=(e=m?.contract_address)?e:""}),[m]),{isNative:O=!1,tokenAddress:P=""}=m||{},x=(0,r.useCallback)((function(e,t=!0){d.U.market.token.unsupportedToken({name:a,action:e}),t&&c.Dialog.show({title:k.formatMessage({id:i.ETranslations.earn_unsupported_token}),tone:"warning",icon:"ErrorOutline",renderContent:(0,A.jsx)(c.SizableText,{size:"$bodyLg",children:k.formatMessage({id:i.ETranslations.earn_unsupported_token_desc})}),onConfirmText:k.formatMessage({id:i.ETranslations.explore_got_it})})}),[k,a]),L=(0,r.useCallback)((0,o.A)((function*({allowWatchAccount:e}={allowWatchAccount:!1}){if(b)return g.A.serviceAccount.createAddressIfNotExists({walletId:I?.wallet?.id||"",networkId:b,accountId:I?.account?.id,indexedAccountId:I?.indexedAccount?.id},{allowWatchAccount:e})})),[I,b]),C=(0,r.useCallback)((t=(0,o.A)((function*(e){var t=yield L({allowWatchAccount:"buy"===e});if(t&&b)if(yield g.A.serviceFiatCrypto.isTokenSupported({networkId:b,tokenAddress:P,type:e})){var{url:n,build:a}=yield g.A.serviceFiatCrypto.generateWidgetUrl({networkId:b,tokenAddress:P,accountId:t?.id,type:e});n&&a?(0,f.Dr)(n):x(e)}else x(e)})),function(e){return t.apply(this,arguments)}),[L,b,P,x]),E=(0,r.useCallback)((n=(0,o.A)((function*(e){var navigateToSwapPage=function(t){"modal"===e?h.replace(u.u.SwapMainLand,t):h.pushModal(l.r.SwapModal,{screen:u.u.SwapMainLand,params:t})};if(!b)return x("trade",!1),void navigateToSwapPage({importNetworkId:"unknown"});if(yield L()){if(b){var{isSupportSwap:t,isSupportCrossChain:n}=yield g.A.serviceSwap.checkSupportSwap({networkId:b,contractAddress:O?P:j});if(!t&&!n)return x("trade",!1),void navigateToSwapPage({importNetworkId:b});var o=yield g.A.serviceNetwork.getNetwork({networkId:b});navigateToSwapPage({importFromToken:_objectSpread(_objectSpread({},o),{},{logoURI:O?o.logoURI:void 0,contractAddress:P,networkId:b,isNative:O,networkLogoURI:o.logoURI,symbol:a.toUpperCase(),name:w}),swapTabSwitchType:t?S.qX.SWAP:S.qX.BRIDGE})}}else"modal"===e&&h.pop()})),function(e){return n.apply(this,arguments)}),[j,L,O,w,h,b,P,x,a]),T=(0,r.useCallback)((0,o.A)((function*(){var e=yield L();e&&b&&e&&h.pushModal(l.r.StakingModal,{screen:p.Ax.AssetProtocolList,params:{networkId:b,accountId:e.id,indexedAccountId:e.indexedAccountId,symbol:a}})})),[L,h,b,a]),D=(0,r.useMemo)((function(){return(0,y.r)(a)}),[a]);return(0,r.useMemo)((function(){return{onSwap:E,onStaking:T,onBuy:function(){C("buy")},onSell:function(){C("sell")},createAccountIfNotExists:L,canStaking:D}}),[D,L,C,T,E])},useLazyMarketTradeActions=function(e){var[t,n]=(0,r.useState)(null),a=(0,r.useCallback)((0,o.A)((function*(){var t=yield g.A.serviceMarket.fetchMarketTokenDetail(e);return n(t),t})),[e]),s=useMarketTradeActions(t),c=(0,r.useRef)(s);c.current=s;var i=(0,v.A)(),d=(0,r.useCallback)((function(e){var t,n=(t=(0,o.A)((function*(){yield a(),yield w.A.wait(80),yield c.current[e]("modal")})),function callback(){return t.apply(this,arguments)});n()}),[a]),p=(0,r.useCallback)((0,o.A)((function*(){i.pushModal(l.r.SwapModal,{screen:u.u.SwapLazyMarketModal,params:{coinGeckoId:e}})})),[e,i]);return(0,r.useMemo)((function(){return{onSwap:function(){return d("onSwap")},onSwapLazyModal:p,onStaking:function(){return d("onStaking")},onBuy:function(){return d("onBuy")},onSell:function(){return d("onSell")}}}),[d,p])}},46307:(e,t,n)=>{n.r(t),n.d(t,{default:()=>SwapLazyMarketModal});var a=n(324586),o=n(514041),r=n(908867),s=n(490343),c=n(904121),i=n(123890),d=n(334439),p=n(714191),l=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function BaseSwapLazyMarketModalModal({route:e}){var{coinGeckoId:t}=e.params,n=(0,r.A)(),{onSwap:a}=(0,i.z6)(t);return(0,o.useLayoutEffect)((function(){a()}),[a]),(0,l.jsxs)(s.Page,{"data-sentry-element":"Page","data-sentry-component":"BaseSwapLazyMarketModalModal","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapLazyMarketModal.tsx",children:[(0,l.jsx)(s.Page.Header,{title:n.formatMessage({id:d.ETranslations.global_trade}),"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapLazyMarketModal.tsx"}),(0,l.jsx)(s.Page.Body,{"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapLazyMarketModal.tsx",children:(0,l.jsx)(s.Stack,{flex:1,ai:"center",jc:"center","data-sentry-element":"Stack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapLazyMarketModal.tsx",children:(0,l.jsx)(s.Spinner,{size:"large","data-sentry-element":"Spinner","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapLazyMarketModal.tsx"})})})]})}function SwapLazyMarketModal(e){return(0,l.jsx)(c.b8,{config:{sceneName:p.Zs.home,sceneUrl:""},enabledNum:[0],"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"SwapLazyMarketModal","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapLazyMarketModal.tsx",children:(0,l.jsx)(BaseSwapLazyMarketModalModal,_objectSpread(_objectSpread({},e),{},{"data-sentry-element":"BaseSwapLazyMarketModalModal","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapLazyMarketModal.tsx"}))})}},317192:(e,t,n)=>{n.d(t,{J:()=>getImportFromToken,r:()=>isSupportStaking});var a=n(625931),o=n(619390),r={networkId:"evm--1",contractAddress:"",name:"Ethereum",symbol:"ETH",decimals:18,isNative:!0,networkLogoURI:"https://uni.onekey-asset.com/static/chain/eth.png"},s={networkId:"evm--1",contractAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",name:"USD Coin",symbol:"USDC",decimals:6,isNative:!1,isPopular:!0,networkLogoURI:"https://uni.onekey-asset.com/static/chain/eth.png"},c={networkId:"sol--101",contractAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",name:"USDC",symbol:"USDC",decimals:6,isNative:!1,networkLogoURI:"https://uni.onekey-asset.com/static/chain/sol.png"},isSupportStaking=function(e){return["BTC","SBTC","ETH","SOL","APT","ATOM","MATIC"].includes(e.toUpperCase())};function getImportFromToken({networkId:e,tokenSymbol:t,isSupportSwap:n=!0}){var i,d=n?o.qX.SWAP:o.qX.BRIDGE,p=(0,a.V)();switch(e){case p.btc:case p.sbtc:i=r,d=o.qX.BRIDGE;break;case p.eth:case p.holesky:case p.sepolia:i="MATIC"===t?r:s,d=o.qX.SWAP;break;case p.sol:i=c,d=o.qX.SWAP;break;case p.apt:i=r,d=o.qX.BRIDGE}return{importFromToken:i,swapTabSwitchType:d}}}}]);
//# sourceMappingURL=46307.e7b7426a3b.chunk.js.map
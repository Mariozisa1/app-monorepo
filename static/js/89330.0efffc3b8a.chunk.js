!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="a6ade2dc-c8ba-4776-8aa2-79ef672b1a0e",e._sentryDebugIdIdentifier="sentry-dbid-a6ade2dc-c8ba-4776-8aa2-79ef672b1a0e")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"5.5.1 (2024123091)"},(self.webpackChunkweb=self.webpackChunkweb||[]).push([[89330],{304695:(e,t,n)=>{n.d(t,{V:()=>NetworksFilterItem});var r=n(324586),o=n(839850),a=n(17617),c=n(490343),s=n(831085),i=["networkImageUri","networkName","isSelected","tooltipContent","disabled"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function NetworksFilterItem(e){var{networkImageUri:t,networkName:n,isSelected:r,tooltipContent:d,disabled:u}=e,l=(0,o.A)(e,i),p=(0,s.jsxs)(c.XStack,_objectSpread(_objectSpread(_objectSpread(_objectSpread({justifyContent:"center",px:"$3",py:"$1.5",borderRadius:"$2",userSelect:"none",borderWidth:a.A.hairlineWidth,borderColor:r?"$borderActive":"$border"},!r&&!u&&{focusable:!0,hoverStyle:{bg:"$bgStrongHover"},pressStyle:{bg:"$bgStrongActive"},focusVisibleStyle:{outlineWidth:2,outlineStyle:"solid",outlineColor:"$focusRing"}}),u&&{opacity:.5}),l),{},{children:[t?(0,s.jsx)(c.Image,{height:"$6",width:"$6",borderRadius:"$full",$gtMd:{height:"$5",width:"$5"},children:(0,s.jsx)(c.Image.Source,{source:{uri:t}})}):null,n?(0,s.jsx)(c.SizableText,{numberOfLines:1,color:r?"$text":"$textSubdued",size:"$bodyLgMedium",$gtMd:{size:"$bodyMdMedium"},children:n}):null]}));return d?(0,s.jsx)(c.Tooltip,{renderContent:d,placement:"top",renderTrigger:p,"data-sentry-element":"Tooltip","data-sentry-component":"NetworksFilterItem","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/NetworksFilterItem/index.tsx"}):p}},771821:(e,t,n)=>{n.d(t,{v:()=>TokenListItem});var r=n(324586),o=n(839850),a=n(490343),c=n(791088),s=n(491180),i=n(391944),d=n(831085),u=["tokenImageSrc","networkImageSrc","tokenName","isSearch","tokenSymbol","tokenContrastAddress","balance","valueProps","disabled","titleMatchStr","moreComponent"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function TokenListItem(e){var t,{tokenImageSrc:n,networkImageSrc:r,tokenName:l,isSearch:p,tokenSymbol:k,tokenContrastAddress:w,balance:f,valueProps:m,disabled:S,titleMatchStr:b,moreComponent:I}=e,y=(0,o.A)(e,u);return(0,d.jsxs)(c.c,_objectSpread(_objectSpread(_objectSpread({userSelect:"none"},p&&{$md:{alignItems:"flex-start"}}),y),{},{"data-sentry-element":"ListItem","data-sentry-component":"TokenListItem","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TokenListItem/index.tsx",children:[(0,d.jsx)(a.YStack,_objectSpread(_objectSpread({},S&&{opacity:.5}),{},{"data-sentry-element":"YStack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TokenListItem/index.tsx",children:(0,d.jsx)(i.o,{tokenImageUri:n,networkImageUri:r,"data-sentry-element":"Token","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TokenListItem/index.tsx"})})),(0,d.jsx)(c.c.Text,_objectSpread(_objectSpread({},S&&{opacity:.5}),{},{flex:1,primary:k,primaryMatch:b,primaryTextProps:{numberOfLines:1},secondary:p?(0,d.jsxs)(a.Stack,{gap:"$0.5",$gtMd:{flexDirection:"row",gap:"$1"},children:[(0,d.jsx)(a.SizableText,{numberOfLines:1,color:"$textSubdued",size:"$bodyMd",children:l}),(0,d.jsx)(a.SizableText,{color:"$textDisabled",size:"$bodyMd",children:s.A.shortenAddress({address:w,leadingLength:8,trailingLength:6})})]}):null!=l?l:"","data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TokenListItem/index.tsx"})),(0,d.jsx)(c.c.Text,_objectSpread(_objectSpread({},S&&{opacity:.5}),{},{align:"right",primary:(0,d.jsx)(a.NumberSizeableText,{textAlign:"right",color:"$text",formatter:"balance",size:"$bodyLgMedium",children:f}),secondary:m?.value?(0,d.jsx)(a.NumberSizeableText,{textAlign:"right",size:"$bodyMd",formatter:"value",color:"$textSubdued",formatterOptions:{currency:null!=(t=m?.currency)?t:"$"},children:m.value}):null,"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/components/TokenListItem/index.tsx"})),I]}))}},82506:(e,t,n)=>{n.d(t,{d:()=>useDebounce});var r=n(578104);function useDebounce(e,t,n){var[o]=(0,r.d7)(e,t,n);return o}},20322:(e,t,n)=>{n.d(t,{Gr:()=>useSwapRecipientAddressInfo,jA:()=>useSwapFromAccountNetworkSync,zf:()=>useSwapAddressInfo});var r=n(324586),o=n(586330),a=n(712784),c=n.n(a),s=n(514041),i=n(490343),d=n(153763),u=n(471169),l=n(193068),p=n(491180),k=n(553083),w=n(619390),f=n(643087),m=n(317522),S=n(911998),b=n(162616),I=n(325529);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useSwapFromAccountNetworkSync(){var{updateSelectedAccountNetwork:e}=(0,b.z$)().current,[t]=(0,I.NE)(),{activeAccount:n}=(0,b.LH)({num:1}),{activeAccount:r}=(0,b.LH)({num:0}),[a,p]=(0,I.rv)(),[k]=(0,I.dF)(),[,w]=(0,u.useSettingsAtom)(),[f]=(0,I.Q8)(),S=(0,s.useRef)(),y=(0,s.useRef)(),g=(0,s.useRef)(),h=(0,s.useRef)(a),v=(0,s.useRef)(n),A=(0,s.useRef)(r);v.current!==n&&(v.current=n),A.current!==r&&(A.current=r),S.current!==t&&(S.current=t),y.current!==f&&(y.current=f),h.current!==a&&(h.current=a),g.current!==k&&(g.current=k);var T,j=(0,s.useCallback)(c()((0,o.A)((function*(){S.current&&(yield e({num:0,networkId:S.current?.networkId})),y.current&&(yield e({num:1,networkId:y.current?.networkId})),S.current&&y.current&&(h.current?.networkId&&y.current?.networkId!==h.current?.networkId||!h.current?.networkId&&!v.current?.account&&v.current?.wallet||!1===g.current||!h.current.address&&v.current.account?.id!==A.current.account?.id)&&(w((function(e){return _objectSpread(_objectSpread({},e),{},{swapToAnotherAccountSwitchOn:!1})})),p((function(e){return _objectSpread(_objectSpread({},e),{},{address:void 0})})),setTimeout((function(){y.current?.networkId&&v.current.network?.id&&y.current?.networkId!==v.current.network.id&&e({num:1,networkId:y.current?.networkId})}),500))})),100),[w,e]),x=(0,i.usePageType)();(0,m.A)(l.V4.Swap,(T=(0,o.A)((function*(e,t){if(x!==i.EPageType.modal){if(t)return;e&&(yield j())}})),function(e,t){return T.apply(this,arguments)})),(0,s.useEffect)((function(){x!==i.EPageType.modal&&(0,o.A)((function*(){yield j()}))()}),[j,t?.networkId,t?.contractAddress,f?.networkId,f?.contractAddress,k,x]);var O=(0,d.E)();(0,s.useEffect)((function(){x===i.EPageType.modal&&O&&(0,o.A)((function*(){yield j()}))()}),[j,O,x,t?.networkId,t?.contractAddress,f?.networkId,f?.contractAddress,k])}function useSwapAddressInfo(e){var{activeAccount:t}=(0,b.LH)({num:e===w.En.FROM?0:1}),[{swapToAnotherAccountSwitchOn:n}]=(0,u.useSettingsAtom)(),[r]=(0,I.rv)();return(0,s.useMemo)((function(){var o={networkId:void 0,address:void 0,accountInfo:void 0,activeAccount:void 0};return e===w.En.TO&&n&&r.address&&r.networkId&&t&&t.network?.id===r.networkId?_objectSpread(_objectSpread({},o),{},{address:r.address,networkId:r.networkId,accountInfo:r.accountInfo,activeAccount:_objectSpread({},t)}):t?_objectSpread(_objectSpread({},o),{},{address:t.account?.address,networkId:t.network?.id,accountInfo:_objectSpread({},t),activeAccount:_objectSpread({},t)}):o}),[e,n,r,t])}function useSwapRecipientAddressInfo(e){var t=useSwapAddressInfo(w.En.FROM),n=useSwapAddressInfo(w.En.TO),[r]=(0,I.Zr)(),[{swapToAnotherAccountSwitchOn:a}]=(0,u.useSettingsAtom)(),[c]=(0,I.rv)(),s=(0,S.yk)((0,o.A)((function*(){return e?n.networkId&&!k.Ay.isAllNetwork({networkId:n.networkId})&&t.accountInfo?.account?.id&&t.accountInfo?.indexedAccount?.id?yield f.A.serviceStaking.getEarnAccount({accountId:t.accountInfo?.account?.id,networkId:n.networkId,indexedAccountId:t.accountInfo?.indexedAccount?.id}):void 0:null})),[e,n.networkId,t.accountInfo?.account?.id,t.accountInfo?.indexedAccount?.id],{}),i=(0,S.yk)((0,o.A)((function*(){if(c.networkId&&c.address){var e=yield f.A.serviceAccount.getAccountNameFromAddress({networkId:c.networkId,address:c.address});if(e.length>0)return e[0]}})),[c.address,c.networkId],{});if(n.address===c.address&&a&&(s?.result?.accountAddress&&s?.result?.accountAddress!==c.address||!s?.result?.accountAddress)&&c.networkId===r?.toTokenInfo.networkId)return{accountInfo:c.accountInfo?.account?.address===c.address?{walletName:c.accountInfo?.wallet?.name,accountName:c.accountInfo?.accountName,accountId:c.accountInfo?.account?.id}:i.result,showAddress:p.A.shortenAddress({address:c.address,leadingLength:6,trailingLength:6}),isExtAccount:c.accountInfo?.account?.address!==c.address&&!i.result}}},866063:(e,t,n)=>{n.d(t,{FI:()=>useSwapInit,GM:()=>useSwapTokenList,ZF:()=>useSwapSelectedTokenInfo});var r=n(712784),o=n.n(r),a=n(324586),c=n(503668),s=n.n(c),i=n(586330),d=n(514041),u=n(241440),l=n(490343),p=n(153763),k=n(471169),w=n(625931),f=n(22937),m=n(193068),S=n(553083),b=n(734818),I=n(58546),y=n(619390),g=n(643087),h=n(317522),v=n(162616),A=n(325529),T=n(20322);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useSwapInit(e){var[t,n]=(0,A.ZM)(),[r,o]=(0,A.NE)(),[a,c]=(0,A.Q8)(),[,u]=(0,k.useInAppNotificationAtom)(),{syncNetworksSort:p,needChangeToken:f}=(0,A.eR)().current,b=(0,T.zf)(y.En.FROM),{updateSelectedAccountNetwork:j}=(0,v.z$)().current,[x,O]=(0,d.useState)(!0),[N,P]=(0,d.useState)(!1),M=(0,d.useRef)(),[$]=(0,A.sK)(),{swapTypeSwitchAction:E}=(0,A.eR)().current;M.current!==b&&(M.current=b);var _=(0,d.useRef)([]);_.current!==t&&(_.current=t);var R=(0,d.useRef)();R.current!==r&&(R.current=r);var C=(0,d.useRef)();C.current!==a&&(C.current=a);var L=(0,d.useCallback)((0,i.A)((function*(){if(t.length)O(!1);else{var e=yield g.A.simpleDb.swapNetworksSort.getRawData();if(e?.data?.length){var r=e?.data.every((function(e){return s()(e.supportCrossChainSwap)&&s()(e.supportSingleSwap)}));r?(e=null,g.A.simpleDb.swapNetworksSort.setRawData({data:[]})):(n(e.data),O(!1))}var o=[],a=yield g.A.serviceSwap.fetchSwapNetworks();if(o=[...a],e?.data?.length&&a?.length){var c=e.data;o=c.filter((function(e){return a.find((function(t){return t.networkId===e.networkId}))})).map((function(e){var t=a.find((function(t){return t.networkId===e.networkId}));return _objectSpread(_objectSpread({},e),t)})).concat(a.filter((function(e){return!c.find((function(t){return t.networkId===e.networkId}))})))}o.length&&(yield g.A.simpleDb.swapNetworksSort.setRawData({data:o}),e?.data?.length&&e?.data?.length===o.length||(n(o),O(!1)))}})),[n,t.length]),D=(0,d.useCallback)((function(n,r){var o=t.find((function(e){return e.networkId===n.networkId})),a=[];if(o&&(o.supportSingleSwap&&(a=[...a,y.qX.SWAP]),o.supportCrossChainSwap&&(a=[...a,y.qX.BRIDGE])),!e?.swapTabSwitchType&&r&&a.length>0&&!a.includes($)){var c,s=a.find((function(e){return e!==$}));if(s)E(s,null!=(c=M.current?.networkId)?c:R.current?.networkId)}return a}),[e?.swapTabSwitchType,t,$,E]),F=(0,d.useCallback)((0,i.A)((function*(){if(!R.current&&!C.current)if(e?.importFromToken&&_.current.find((function(t){return t.networkId===e?.importFromToken?.networkId}))||e?.importToToken&&_.current.find((function(t){return t.networkId===e?.importToToken?.networkId}))){var t,n;if(e?.importFromToken){var r=D(e?.importFromToken);e?.swapTabSwitchType&&r.includes(e?.swapTabSwitchType)&&o(e?.importFromToken)}if(e?.importToToken){var a=D(e?.importToToken);e?.swapTabSwitchType&&a.includes(e?.swapTabSwitchType)&&c(e?.importToToken)}if(e?.importFromToken&&!e?.importToToken){var i,d=f({token:e.importFromToken,swapTypeSwitchValue:null!=(i=e?.swapTabSwitchType)?i:y.qX.SWAP});if(d){var u=D(d);e?.swapTabSwitchType&&u.includes(e?.swapTabSwitchType)&&c(d)}}p(null!=(t=null!=(n=e?.importFromToken?.networkId)?n:e?.importToToken?.networkId)?t:(0,w.V)().onekeyall)}else if(M.current?.accountInfo?.ready&&M.current?.networkId&&_.current.length&&(!e?.importNetworkId||!M.current?.networkId||e?.importNetworkId===M.current?.networkId)&&!N){var l=S.Ay.isAllNetwork({networkId:M.current?.networkId}),k=_.current.find((function(e){return e.networkId===M.current?.networkId})),m=k,b=k?.networkId;if(l){b=(0,w.V)().onekeyall;var g=I.TW[b]?.fromToken;m=_.current.find((function(e){return e.networkId===g?.networkId}))}if(m&&b&&(!s()(I.TW[b]?.fromToken)||!s()(I.TW[b]?.toToken))){var h=I.TW[b]?.fromToken,v=I.TW[b]?.toToken;h&&(o(_objectSpread(_objectSpread({},h),{},{networkLogoURI:l?h.networkLogoURI:m?.logoURI})),p(h.networkId)),v&&(c(_objectSpread(_objectSpread({},v),{},{networkLogoURI:l?v.networkLogoURI:m?.logoURI})),p(v.networkId)),h&&D(h,!0)}}})),[e?.importFromToken,e?.importToToken,e?.importNetworkId,e?.swapTabSwitchType,N,p,D,o,c,f]);(0,d.useEffect)((function(){(0,i.A)((function*(){yield g.A.serviceSwap.swapRecentTokenSync()}))()}),[u]),(0,d.useEffect)((function(){(0,i.A)((function*(){yield L()}))()}),[L,t.length]),(0,d.useEffect)((function(){(0,i.A)((function*(){e?.importNetworkId&&M.current?.networkId&&e?.importNetworkId!==M.current.networkId&&(yield j({num:0,networkId:e?.importNetworkId}))}))()}),[e?.importNetworkId,j]),(0,d.useEffect)((function(){(0,i.A)((function*(){yield F()}))()}),[b.accountInfo?.ready,t.length,b.networkId,e?.importFromToken,e?.importToToken,e?.importNetworkId]);var z=(0,l.usePageType)();return(0,h.A)(m.V4.Swap,(function(e,t){z!==l.EPageType.modal&&e&&P(!!t)})),{fetchLoading:x}}function useSwapTokenList(e,t,n){var[r,o]=(0,d.useState)([]),[{tokenCatch:a}]=(0,A.PQ)(),[c]=(0,A.Yb)(),s=(0,d.useRef)([]),[l]=(0,A.ZM)(),[p]=(0,A.qv)(),{tokenListFetchAction:k,swapLoadAllNetworkTokenList:w}=(0,A.eR)().current,m=(0,T.zf)(e),[I]=(0,A.Hb)();(0,d.useEffect)((function(){(0,i.A)((function*(){var e,{swapSupportAccounts:t}=yield g.A.serviceSwap.getSupportSwapAllAccounts({indexedAccountId:m?.accountInfo?.indexedAccount?.id,otherWalletTypeAccountId:m?.accountInfo?.indexedAccount?.id?void 0:null!=(e=m?.accountInfo?.account?.id)?e:m?.accountInfo?.dbAccount?.id,swapSupportNetworks:l});s.current=t}))()}),[m?.accountInfo?.account?.id,m?.accountInfo?.dbAccount?.id,m?.accountInfo?.indexedAccount?.id,l]);var y=(0,d.useMemo)((function(){var e=s.current.find((function(e){return e.networkId===t}));return m.networkId===t?{networkId:t,keywords:n,accountAddress:m?.address,accountNetworkId:m?.networkId,accountId:m?.accountInfo?.account?.id}:{networkId:t,keywords:n,accountAddress:e?.apiAddress,accountNetworkId:e?.networkId,accountId:e?.accountId}}),[t,m.networkId,m?.address,m?.accountInfo?.account?.id,n]),h=(0,d.useMemo)((function(){var e,t,n;return c[null!=(e=null!=(t=null!=(n=m?.accountInfo?.indexedAccount?.id)?n:m?.accountInfo?.account?.id)?t:m?.accountInfo?.dbAccount?.id)?e:"noAccountId"]}),[c,m?.accountInfo?.indexedAccount?.id,m?.accountInfo?.account?.id,m?.accountInfo?.dbAccount?.id]),v=(0,d.useCallback)((function(e){var t=e.filter((function(e){var t,n=new u.A(null!=(t=e.price)?t:"0");return!n.isNaN()&&!n.isZero()}))?.sort((function(e,t){var n,r,o=new u.A(null!=(n=e.fiatValue)?n:"0");return new u.A(null!=(r=t.fiatValue)?r:"0").comparedTo(o)})),n=e.filter((function(e){var t,n=new u.A(null!=(t=e.price)?t:"0");return n.isNaN()||n.isZero()}))?.sort((function(e,t){var n,r,o=new u.A(null!=(n=e.fiatValue)?n:"0");return new u.A(null!=(r=t.fiatValue)?r:"0").comparedTo(o)}));return[...t,...n]}),[]),j=(0,d.useCallback)((function({swapAllNetRecommend:e,swapSearchTokens:t}){var n,r;if(e?.length&&!h)return[];var o=null!=(n=h?.map((function(e){var t=l.find((function(t){return t.networkId===e.networkId}));return t?_objectSpread(_objectSpread({},e),{},{networkLogoURI:t.logoURI}):e}))?.filter((function(e){return p.find((function(t){return t.networkId===e.networkId}))})))?n:[],a=null!=(r=o?.filter((function(e){var t,n=new u.A(null!=(t=e?.balanceParsed)?t:"0");return!n.isNaN()&&!n.isZero()})))?r:[];if(e){var c,s=null!=(c=e?.filter((function(e){return!a?.find((function(t){return(0,b.BQ)({token1:{networkId:t?.networkId,contractAddress:t?.contractAddress},token2:{networkId:e?.networkId,contractAddress:e?.contractAddress}})}))}))?.filter((function(e){return p.find((function(t){return t.networkId===e.networkId}))})))?c:[],i=[...a,...s];return v(null!=i?i:[])}if(t){var d=t.map((function(e){if(p.find((function(t){return t.networkId===e.networkId}))){var t=a.find((function(t){return t?.contractAddress===e?.contractAddress&&t?.networkId===e?.networkId}));return t||e}})).filter((function(e){return e}));return v(null!=d?d:[])}return[]}),[v,h,l,p]),x=(0,f.bJ)(S.Ay.isAllNetwork({networkId:y.networkId})&&n?j({swapSearchTokens:a?.[JSON.stringify(y)]?.data||[]}):a?.[JSON.stringify(y)]?.data||[],{shouldSort:!1,keys:["symbol","contractAddress"]}),O=(0,d.useRef)(x);return O.current!==x&&(O.current=x),(0,d.useEffect)((function(){var e;y.networkId&&!n&&S.Ay.isAllNetwork({networkId:y.networkId})&&w(m?.accountInfo?.indexedAccount?.id,m?.accountInfo?.indexedAccount?.id?void 0:null!=(e=m?.accountInfo?.account?.id)?e:m?.accountInfo?.dbAccount?.id);k(y)}),[m?.accountInfo?.account?.id,m?.accountInfo?.dbAccount?.id,m?.accountInfo?.indexedAccount?.id,w,y,k,n]),(0,d.useEffect)((function(){n&&O.current?o(O.current.search(n)):o(S.Ay.isAllNetwork({networkId:y.networkId})?j({swapAllNetRecommend:a?.[JSON.stringify(y)]?.data||[]}):a?.[JSON.stringify(y)]?.data||[])}),[a,y,t,n,j]),{fetchLoading:I&&0===r.length||S.Ay.isAllNetwork({networkId:y.networkId})&&!h,currentTokens:r}}function useSwapSelectedTokenInfo({token:e,type:t}){var n=(0,T.zf)(y.En.FROM),[r,a]=(0,d.useState)(0),[{swapHistoryPendingList:c}]=(0,k.useInAppNotificationAtom)(),{loadSwapSelectTokenDetail:s}=(0,A.eR)().current,i=(0,d.useRef)(c);i.current!==c&&(i.current=c);var u=(0,d.useRef)(r);u.current!==r&&(u.current=r);var w=(0,d.useRef)(n);w.current!==n&&(w.current=n);var f=(0,p.E)(),S=(0,d.useRef)(f);S.current!==f&&(S.current=f);var b=(0,d.useCallback)(o()((function(e,t,n){s(e,t,n)}),200),[]);(0,d.useEffect)((function(){if(S.current&&c.length){var e=c.filter((function(e){return e.status===y.lr.SUCCESS})).length;e>u.current&&(b(t,w.current,!0),a(e))}}),[b,c,t]),(0,d.useEffect)((function(){b(t,w.current,!e?.reservationValue&&e?.isNative)}),[t,n,e?.networkId,e?.contractAddress,e?.balanceParsed,b,e?.reservationValue,e?.isNative]);var I=(0,l.usePageType)();(0,h.A)(m.V4.Swap,(function(e,n){if(I!==l.EPageType.modal&&e&&!n&&i.current.length){var r=i.current.filter((function(e){return e.status===y.lr.SUCCESS})).length;r>u.current&&(b(t,w.current,!0),a(r))}}))}},309008:(e,t,n)=>{n.d(t,{o:()=>u});var r=n(324586),o=n(514041),a=n(325529),c=n(2577),s=n(597102),i=n(829561),d=n(831085);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=(0,o.memo)((function(e){var{children:t,storeName:n}=e,r=(0,i.x6)(n),o=c.A.getOrCreateStore(r);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.H,_objectSpread({},r)),(0,d.jsx)(a.BY,{store:o,children:t})]})}));u.displayName="SwapProviderMirror"},89330:(e,t,n)=>{n.r(t),n.d(t,{default:()=>SwapTokenSelectModal});var r=n(324586),o=n(586330),a=n(514041),c=n(654266),s=n(241440),i=n(908867),d=n(490343),u=n(643087),l=n(904121),p=n(791088),k=n(771821),w=n(498356),f=n(82506),m=n(162616),S=n(325529),b=n(471169),I=n(334439),y=n(663522),g=n(628380),h=n(491180),v=n(117746),A=n(734818),T=n(714191),j=n(58546),x=n(619390),O=n(885127),N=n(812715),P=n(304695),M=n(831085);const $=(0,a.memo)((function({networks:e,selectedNetwork:t,onSelectNetwork:n,disableMoreNetworks:r,disableNetworks:o,moreNetworksCount:c,onMoreNetwork:s}){var{width:u}=(0,N.A)(),l=(0,i.A)(),p=u>380,k=(0,a.useMemo)((function(){return p?e:e.slice(0,4)}),[e,p]);return(0,M.jsxs)(d.XStack,{px:"$5",pt:"$1",pb:"$3",gap:"$2","data-sentry-element":"XStack","data-sentry-component":"SwapNetworkToggleGroup","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/components/SwapNetworkToggleGroup.tsx",children:[k.map((function(e){return(0,M.jsx)(P.V,{disabled:Boolean(o?.includes(e.networkId)),networkImageUri:e.logoURI,tooltipContent:e.isAllNetworks?l.formatMessage({id:I.ETranslations.global_all_networks}):e.name,isSelected:e?.networkId===t?.networkId,onPress:o?.includes(e.networkId)?void 0:function(){n(e)}},e.networkId)})),c&&c>0?(0,M.jsx)(P.V,{disabled:r,networkName:`${c}+`,flex:1,onPress:r?void 0:s}):null]})}));var E=n(17617);const _=(0,a.memo)((function({onSelectToken:e,selectedToken:t,tokens:n}){return(0,M.jsx)(d.XStack,{pt:"$1",pb:"$3",gap:"$1.5",flexWrap:"wrap","data-sentry-element":"XStack","data-sentry-component":"SwapPopularTokenGroup","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/components/SwapPopularTokenGroup.tsx",children:n.map((function(n){return(0,M.jsxs)(d.XStack,{role:"button",userSelect:"none",alignItems:"center",px:"$1.5",py:"$1",bg:"$bg",borderRadius:"$4",borderWidth:E.A.hairlineWidth,borderColor:"$borderSubdued",hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},focusable:!0,focusVisibleStyle:{outlineColor:"$focusRing",outlineStyle:"solid",outlineWidth:2,outlineOffset:2},disabled:!!(0,A.BQ)({token1:t,token2:n}),onPress:function(){e(n)},disabledStyle:{opacity:.5},children:[(0,M.jsx)(d.Image,{height:"$4.5",width:"$4.5",borderRadius:"$full",children:(0,M.jsx)(d.Image.Source,{source:{uri:n.logoURI}})}),(0,M.jsx)(d.SizableText,{pl:"$1",size:"$bodyLgMedium",children:n.symbol})]},n.contractAddress)}))})}));var R=n(20322),C=n(866063),L=n(309008);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var SwapTokenSelectPage=function(){var e=(0,w.A)(),t=(0,c.lq)(),n=(0,a.useMemo)((function(){var e;return null!=(e=t.params?.type)?e:x.En.FROM}),[t.params?.type]),r=(0,i.A)(),[l,T]=(0,a.useState)(""),N=(0,f.d)(l,500),[P]=(0,S.qv)(),[E]=(0,S.qv)(),[L]=(0,S.NE)(),[D]=(0,S.sK)(),F=(0,R.zf)(x.En.FROM),z=(0,R.zf)(x.En.TO),[U]=(0,S.Q8)(),[V]=(0,b.useSettingsPersistAtom)(),{selectFromToken:K,selectToToken:W,syncNetworksSort:X}=(0,S.eR)().current,{updateSelectedAccountNetwork:B}=(0,m.z$)().current,q=(0,a.useCallback)((function(){if(n===x.En.FROM){var e,t;if(L?.networkId)return null!=(e=E.find((function(e){return e.networkId===L.networkId})))?e:E?.[0];if(U?.networkId&&D===x.qX.SWAP)return null!=(t=E.find((function(e){return e.networkId===U.networkId})))?t:E?.[0]}else{var r,o;if(U?.networkId)return null!=(r=E.find((function(e){return e.networkId===U.networkId})))?r:E?.[0];if(L?.networkId&&D===x.qX.SWAP)return null!=(o=E.find((function(e){return e.networkId===L.networkId})))?o:E?.[0]}return E?.[0]}),[L?.networkId,E,D,U?.networkId,n]),[Z,G]=(0,a.useState)(q),Y=(0,a.useRef)(null);(0,a.useEffect)((function(){var e=n===x.En.FROM?F.networkId:z.networkId;Z?.networkId&&Z?.networkId!==e&&B({num:n===x.En.FROM?0:1,networkId:Z?.networkId})}),[]);var H,Q,{fetchLoading:J,currentTokens:ee}=(0,C.GM)(n,Z?.networkId,N),te=(0,a.useMemo)((function(){return ee.findIndex((function(e){var t=e.item?e.item:e;return!t.price||new s.A(t.price).isZero()}))}),[ee]),ne=(0,a.useCallback)((H=(0,o.A)((function*(e){var t=!e.isPopular&&(!e.price||new s.A(e.price).isZero()||e.riskLevel===x.eU.SPAM||e.riskLevel===x.eU.MALICIOUS);return t?!!V.tokenRiskReminder&&!(yield u.A.serviceSetting.checkConfirmedRiskToken(`${e.networkId}_${e.contractAddress}`)):t})),function(e){return H.apply(this,arguments)}),[V.tokenRiskReminder]),re=(0,a.useCallback)((function(t){e.popStack(),n===x.En.FROM?K(t):W(t)}),[e,K,W,n]),oe=(0,a.useCallback)((Q=(0,o.A)((function*(n){(yield ne(n))?e.push(g.u.TokenRiskReminder,{storeName:t.params.storeName,token:n,onConfirm:function(){re(n)}}):re(n)})),function(e){return Q.apply(this,arguments)}),[ne,e,t.params.storeName,re]),ae=(0,a.useCallback)((function(e){G(e),Y.current?.scrollToOffset({offset:0,animated:!1})}),[]),ce=(0,a.useCallback)((function(e){return(0,A.BQ)({token1:{networkId:n===x.En.FROM?U?.networkId:L?.networkId,contractAddress:n===x.En.FROM?U?.contractAddress:L?.contractAddress},token2:{networkId:e.networkId,contractAddress:e.contractAddress}})}),[L?.contractAddress,L?.networkId,U?.contractAddress,U?.networkId,n]),{md:se}=(0,d.useMedia)(),{copyText:ie}=(0,d.useClipboard)(),de=(0,a.useMemo)((function(){var e=[],t=E.map((function(e){return e.networkId}));return D===x.qX.SWAP&&n===x.En.TO&&L&&(e=t.filter((function(e){return e!==L?.networkId}))),n===x.En.TO&&L&&D===x.qX.BRIDGE&&(e=t.filter((function(e){return e===L?.networkId}))),n===x.En.FROM&&D===x.qX.BRIDGE&&U&&(e=t.filter((function(e){return e===U?.networkId}))),e}),[L,E,D,U,n]),ue=(0,a.useCallback)((function({item:e,index:t}){var n,a,c,i,l=e.item?e.item:e,w=new s.A(null!=(n=l.balanceParsed)?n:0),f=new s.A(null!=(a=l.fiatValue)?a:0),m=se?h.A.shortenAddress({address:l.contractAddress}):l.contractAddress,S={isSearch:!!N,tokenImageSrc:l.logoURI,tokenName:l.name,tokenSymbol:l.symbol,networkImageSrc:l.networkLogoURI,tokenContrastAddress:N?m:void 0,balance:w.isZero()?void 0:l.balanceParsed,valueProps:l.fiatValue&&!f.isZero()?{value:l.fiatValue,currency:V.currencyInfo.symbol}:void 0,onPress:ce(l)||de.includes(l.networkId)?void 0:function(){return oe(l)},disabled:ce(l)||de.includes(l.networkId),titleMatchStr:e.matches?.find((function(e){return"symbol"===e.key}))};return(0,M.jsxs)(M.Fragment,{children:[te===t?(0,M.jsx)(d.Stack,{pt:"$3",pb:"$2",children:(0,M.jsx)(d.Alert,{fullBleed:!0,type:"default",title:r.formatMessage({id:I.ETranslations.token_selector_unverified_token_warning}),icon:"InfoCircleOutline"})}):null,(0,M.jsx)(k.v,_objectSpread(_objectSpread({},S),{},{moreComponent:(0,M.jsx)(d.Stack,{alignSelf:"center",children:(0,M.jsx)(d.ActionList,{title:null!=(c=S.tokenSymbol)?c:"",disabled:l.isNative,renderTrigger:(0,M.jsx)(p.c.IconButton,{icon:"DotVerSolid",variant:"tertiary"}),items:[{icon:"Copy3Outline",label:r.formatMessage({id:I.ETranslations.global_copy_token_contract}),onPress:function(){ie(l.contractAddress)},disabled:l.isNative},{icon:"OpenOutline",label:r.formatMessage({id:I.ETranslations.swap_token_selector_contract_info}),onPress:(i=(0,o.A)((function*(){var e=yield u.A.serviceExplorer.buildExplorerUrl({networkId:l.networkId,type:"token",param:l.contractAddress});(0,v.Dr)(e)})),function onPress(){return i.apply(this,arguments)}),disabled:l.isNative}]})})}))]})}),[te,ie,de,r,se,oe,ce,N,V.currencyInfo.symbol]),le=(0,a.useMemo)((function(){var e=!1,t=E.length-de.length;return se?t<=j.ck&&(e=!0):t<=j.BT&&(e=!0),e}),[de.length,se,E.length]),pe=(0,a.useMemo)((function(){var e,t=[];return E&&E.length&&(se?(t=E.length>j.ck?E.slice(0,j.ck):E,e=E.length-j.ck>0?E.length-j.ck:void 0):(t=E.length>j.BT?E.slice(0,j.BT):E,e=E.length-j.BT>0?E.length-j.BT:void 0)),{swapNetworksCommon:t,swapNetworksMoreCount:e}}),[se,E]),ke=(0,O.A)(),{bottom:we}=(0,d.useSafeAreaInsets)(),fe=(0,a.useMemo)((function(){var e;return Z?.networkId&&null!=(e=j.hm[Z?.networkId])?e:[]}),[Z?.networkId]);return(0,M.jsxs)(d.Page,{skipLoading:y.Ay.isNativeIOS,safeAreaEnabled:!1,"data-sentry-element":"Page","data-sentry-component":"SwapTokenSelectPage","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx",children:[(0,M.jsx)(d.Page.Header,{title:r.formatMessage({id:I.ETranslations.token_selector_title}),headerSearchBarOptions:{placeholder:r.formatMessage({id:I.ETranslations.token_selector_search_placeholder}),onChangeText:function({nativeEvent:e}){var t=e.text.trim();T(t)}},"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx"}),(0,M.jsxs)(d.Page.Body,{"data-sentry-element":"unknown","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx",children:[(0,M.jsxs)(d.XStack,{px:"$5",pb:"$2","data-sentry-element":"XStack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx",children:[(0,M.jsx)(d.SizableText,{size:"$bodyMd",color:"$textSubdued",pr:"$2","data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx",children:`${r.formatMessage({id:I.ETranslations.token_selector_network})}`}),(0,M.jsx)(d.XStack,{"data-sentry-element":"XStack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx",children:(0,M.jsx)(d.SizableText,{size:"$bodyMd","data-sentry-element":"SizableText","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx",children:Z?.isAllNetworks?r.formatMessage({id:I.ETranslations.global_all_networks}):Z?.name})})]}),(0,M.jsx)($,{onMoreNetwork:function(){ke({defaultNetworkId:Z?.networkId,networkIds:P.filter((function(e){return!e.isAllNetworks})).filter((function(e){return!de.includes(e.networkId)})).map((function(e){return e.networkId})),grouped:!1,onSelect:function(e){if(e){var t=P.find((function(t){return t.networkId===e.id}));t&&(ae(t),X(t.networkId))}}})},networks:pe.swapNetworksCommon,moreNetworksCount:pe.swapNetworksMoreCount,selectedNetwork:Z,disableNetworks:de,disableMoreNetworks:le,onSelectNetwork:ae,"data-sentry-element":"NetworkToggleGroup","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx"}),fe.length>0&&!N?(0,M.jsx)(d.Divider,{mt:"$2"}):null,(0,M.jsx)(d.YStack,{flex:1,"data-sentry-element":"YStack","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx",children:(0,M.jsx)(d.ListView,{ref:Y,data:ee,renderItem:ue,estimatedItemSize:60,ListHeaderComponent:fe.length>0&&!N?(0,M.jsxs)(d.YStack,{px:"$5",pt:"$3",gap:"$2",children:[(0,M.jsx)(d.SizableText,{size:"$bodyMd",color:"$textSubdued",pr:"$2",children:`${r.formatMessage({id:I.ETranslations.swap_token_selector_popular_token})}`}),(0,M.jsx)(_,{onSelectToken:oe,selectedToken:n===x.En.FROM?U:L,tokens:fe})]}):null,ListFooterComponent:(0,M.jsx)(d.Stack,{h:we||"$2"}),ListEmptyComponent:J?(0,M.jsx)(M.Fragment,{children:Array.from({length:5}).map((function(e,t){return(0,M.jsxs)(p.c,{children:[(0,M.jsx)(d.Skeleton,{w:"$10",h:"$10",radius:"round"}),(0,M.jsxs)(d.YStack,{children:[(0,M.jsx)(d.YStack,{py:"$1",children:(0,M.jsx)(d.Skeleton,{h:"$4",w:"$32"})}),(0,M.jsx)(d.YStack,{py:"$1",children:(0,M.jsx)(d.Skeleton,{h:"$3",w:"$24"})})]})]},t)}))}):(0,M.jsx)(d.Empty,{icon:"SearchOutline",title:r.formatMessage({id:I.ETranslations.global_no_results}),description:r.formatMessage({id:I.ETranslations.token_no_search_results_desc})}),"data-sentry-element":"ListView","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx"})})]})]})},SwapTokenSelectPageWithProvider=function(){var e=(0,c.lq)(),{storeName:t}=e.params;return(0,M.jsx)(L.o,{storeName:t,"data-sentry-element":"SwapProviderMirror","data-sentry-component":"SwapTokenSelectPageWithProvider","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx",children:(0,M.jsx)(SwapTokenSelectPage,{"data-sentry-element":"SwapTokenSelectPage","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx"})})};function SwapTokenSelectModal(){return(0,M.jsx)(l.b8,{config:{sceneName:T.Zs.swap},enabledNum:[0,1],"data-sentry-element":"AccountSelectorProviderMirror","data-sentry-component":"SwapTokenSelectModal","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx",children:(0,M.jsx)(SwapTokenSelectPageWithProvider,{"data-sentry-element":"SwapTokenSelectPageWithProvider","data-sentry-source-file":"/home/runner/work/app-monorepo/app-monorepo/packages/kit/src/views/Swap/pages/modal/SwapTokenSelectModal.tsx"})})}}}]);
//# sourceMappingURL=89330.0efffc3b8a.chunk.js.map